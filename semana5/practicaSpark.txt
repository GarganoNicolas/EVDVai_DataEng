>>> df = spark.read.option("header", "true").csv("/ingest/RowData.csv")
[Stage 0:>                                                          (0 + 1[Stage 0:===========================================================(1 + 0                                                                          >>> df_managers = spark.read.option("header", "true").csv("/ingest/Managers.csv")
[Stage 1:>                                                          (0 + 1                                                                          >>> df_managers2 = df_managers \
... .withColumnRenamed("Id", "Id_Manager") \
... .withColumnRenamed("Nombre", "Nombre_Manager") \
... .withColumnRenamed("Apellido", "Apellido_Manager")
>>> df_manager2.printSchema()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'df_manager2' is not defined
>>> df_managers2.printSchema()
root
 |-- Id_Manager: string (nullable = true)
 |-- Nombre_Manager: string (nullable = true)
 |-- Apellido_Manager: string (nullable = true)

>>> dfjoin = df.join(df_managers2, df.Manager == df_managers2.Id_Manager, "inner")
>>> df_rangos_renamed = df_rangos \
... .withColumnRenamed("desde", "sueldo en rublos desde") \
... .withColumnRenamed("hasta", "sueldo en rublos hasta")
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'df_rangos' is not defined
>>> df_managers = spark.read.option("header", "true").csv("/ingest/Managers.csv")
[Stage 2:>                                                          (0 + 0[Stage 2:>                                                          (0 + 1                                                                          >>> df_managers2.printSchema()
root
 |-- Id_Manager: string (nullable = true)
 |-- Nombre_Manager: string (nullable = true)
 |-- Apellido_Manager: string (nullable = true)

>>> df_rangos = spark.read.option("header", "true").csv("/ingest/Rangos.csv")
>>> df_rangos_renamed = df_rangos \
... .withColumnRenamed("desde", "sueldo en rublos desde") \
... .withColumnRenamed("hasta", "sueldo en rublos hasta")
>>> dfjoin = dfjoin.join(df_rangos_renamed, dfjoin['Rango Salarial'] == df_rangos_renamed['Rango'], "inner")
>>> dfjoin.printSchema()
root
 |-- Id: string (nullable = true)
 |-- Nombre: string (nullable = true)
 |-- Apellido: string (nullable = true)
 |-- Area: string (nullable = true)
 |-- Fecha comienzo: string (nullable = true)
 |-- Fecha fin: string (nullable = true)
 |-- Nivel: string (nullable = true)
 |-- Grupo recruitment: string (nullable = true)
 |-- Tiempo recruitment: string (nullable = true)
 |-- Rango Salarial: string (nullable = true)
 |-- RS competencia: string (nullable = true)
 |-- Manager: string (nullable = true)
 |-- Realizo Cursos: string (nullable = true)
 |-- Id_Manager: string (nullable = true)
 |-- Nombre_Manager: string (nullable = true)
 |-- Apellido_Manager: string (nullable = true)
 |-- Rango: string (nullable = true)
 |-- sueldo en rublos desde: string (nullable = true)
 |-- sueldo en rublos hasta: string (nullable = true)

>>> df_bronze = dfjoin
>>> # CONVERTIR ID EN INT
>>> f_silver_id = dfjoin.withColumn("Id", dfjoin["Id"].cast(IntegerType()))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'IntegerType' is not defined
>>> from pyspark.sql.types import IntegerType
>>> df_silver_id = dfjoin.withColumn("Id", dfjoin["Id"].cast(IntegerType()))
>>> from pyspark.sql.functions import to_date
>>> df_silver_datetime = df_silver_id \
... .withColumn("Fecha fin", to_date(df_silver_datetime["Fecha fin"], "MM/dd/yyyy"))
Traceback (most recent call last):
  File "<stdin>", line 2, in <module>
NameError: name 'df_silver_datetime' is not defined
>>> df_silver_datetime = df_silver_id \
... .withColumn("Fecha fin", to_date(df_silver_id["Fecha fin"], "MM/dd/yyyy"))
>>> df_silver_datetime = df_silver_datetime \
... .withColumn("Fecha comienzo", to_date(df_silver_datetime["Fecha comienzo"], "MM/dd/yyyy"))
>>> df_silver_datetime.select(['Fecha fin', 'Fecha comienzo']).show(4)
[Stage 4:>                  (0 + 1) / 1][Stage 5:>                  (0 + 1                                                                          [Stage 6:>                                                          (0 + 1                                                                          +----------+--------------+
| Fecha fin|Fecha comienzo|
+----------+--------------+
|2021-05-30|    2018-05-07|
|2021-03-31|    2020-07-06|
|2021-06-30|    2017-01-02|
|2020-11-30|    2017-03-06|
+----------+--------------+
only showing top 4 rows

>>> df_silver_diastrabajados = df_silver_datetime.withColumn("dias_trabajados", datediff(df_silver_datetime["Fecha fin"], df_silver_datetime["Fecha comienzo"]))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'datediff' is not defined
>>> from pyspark.sql.functions import datediff
>>> df_silver_diastrabajados = df_silver_datetime.withColumn("dias_trabajados", datediff(df_silver_datetime["Fecha fin"], df_silver_datetime["Fecha comienzo"]))
>>> df_silver_diastrabajados.select(['Fecha fin', 'Fecha comienzo', 'dias_trabajados']).show(4)
[Stage 9:>                                                          (0 + 1                                                                          +----------+--------------+---------------+
| Fecha fin|Fecha comienzo|dias_trabajados|
+----------+--------------+---------------+
|2021-05-30|    2018-05-07|           1119|
|2021-03-31|    2020-07-06|            268|
|2021-06-30|    2017-01-02|           1640|
|2020-11-30|    2017-03-06|           1365|
+----------+--------------+---------------+
only showing top 4 rows

>>> df_silver_diastrabajados.printSchema()
root
 |-- Id: integer (nullable = true)
 |-- Nombre: string (nullable = true)
 |-- Apellido: string (nullable = true)
 |-- Area: string (nullable = true)
 |-- Fecha comienzo: date (nullable = true)
 |-- Fecha fin: date (nullable = true)
 |-- Nivel: string (nullable = true)
 |-- Grupo recruitment: string (nullable = true)
 |-- Tiempo recruitment: string (nullable = true)
 |-- Rango Salarial: string (nullable = true)
 |-- RS competencia: string (nullable = true)
 |-- Manager: string (nullable = true)
 |-- Realizo Cursos: string (nullable = true)
 |-- Id_Manager: string (nullable = true)
 |-- Nombre_Manager: string (nullable = true)
 |-- Apellido_Manager: string (nullable = true)
 |-- Rango: string (nullable = true)
 |-- sueldo en rublos desde: string (nullable = true)
 |-- sueldo en rublos hasta: string (nullable = true)
 |-- dias_trabajados: integer (nullable = true)

>>> from pyspark.sql.functions import regexp_replace
>>> # QUITAR LA N EN LA COLUMNA NIVEL Y PASAR A INT LA COLUMNA
>>> df_silver_N = df_silver_diastrabajados.withColumn("Nivel", regexp_replace(df_silver_diastrabajados["Nivel"], "N", ""))
>>> df_silver_N.select('Nivel').show(4)
[Stage 10:>                                                         (0 + 1                                                                          [Stage 12:>                                                         (0 + 1                                                                          +-----+
|Nivel|
+-----+
|    2|
|    4|
|    3|
|    4|
+-----+
only showing top 4 rows

>>> df_silver_N = df_silver_N.withColumn("Nivel", df_silver_N["Nivel"].cast("int"))
>>> df_silver_N.printSchema()
root
 |-- Id: integer (nullable = true)
 |-- Nombre: string (nullable = true)
 |-- Apellido: string (nullable = true)
 |-- Area: string (nullable = true)
 |-- Fecha comienzo: date (nullable = true)
 |-- Fecha fin: date (nullable = true)
 |-- Nivel: integer (nullable = true)
 |-- Grupo recruitment: string (nullable = true)
 |-- Tiempo recruitment: string (nullable = true)
 |-- Rango Salarial: string (nullable = true)
 |-- RS competencia: string (nullable = true)
 |-- Manager: string (nullable = true)
 |-- Realizo Cursos: string (nullable = true)
 |-- Id_Manager: string (nullable = true)
 |-- Nombre_Manager: string (nullable = true)
 |-- Apellido_Manager: string (nullable = true)
 |-- Rango: string (nullable = true)
 |-- sueldo en rublos desde: string (nullable = true)
 |-- sueldo en rublos hasta: string (nullable = true)
 |-- dias_trabajados: integer (nullable = true)

>>> df_silverG = df_silver_N.withColumn("Grupo recruitment", regexp_replace(df_silver_N["Grupo recruitment"], "Grupo", ""))
>>> df_silverG.select(['Id', 'Nivel', 'Grupo recruitment', 'dias_trabajados']).show(4)
[Stage 15:>                                                         (0 + 1                                                                          +---+-----+-----------------+---------------+
| Id|Nivel|Grupo recruitment|dias_trabajados|
+---+-----+-----------------+---------------+
|  4|    2|                A|           1119|
|  7|    4|                A|            268|
|  8|    3|                A|           1640|
| 10|    4|                A|           1365|
+---+-----+-----------------+---------------+
only showing top 4 rows

>>> #TIEMPO  RECRUITMENT A SEMANAS
>>> df_silverTR = df_silverG.withColumnRenamed("Tiempo recruitment", "Tiempo recruitment en semanas")
>>> df_silverTR = df_silverTR.withColumn("Tiempo recruitment en semanas", df_silverTR["Tiempo recruitment en semanas"].cast("int"))
>>> df_silverTR.select(['Rango Salarial', 'Rango', 'RS competencia']).show(4)
[Stage 18:>                                                         (0 + 1                                                                          +--------------+-------+--------------+
|Rango Salarial|  Rango|RS competencia|
+--------------+-------+--------------+
|       Rango 2|Rango 2|       Rango 2|
|       Rango 4|Rango 4|       Rango 4|
|       Rango 3|Rango 3|       Rango 3|
|       Rango 3|Rango 3|       Rango 3|
+--------------+-------+--------------+
only showing top 4 rows

>>> # ESTAMOS TRABAJANDO RANGO, REMOVEMOS LA COLUMNA DUPLICADA, SACAMOS LA PALABRA RANGO Y PASAMOS A IN, ADEMAS PASAMOS LOS SUELDOS A PROMEDIO PARA TENER UN SOLO NUMERO Y NO DOS
>>> df_RS = df_silverTR.drop('Rango')
>>> df_RS = df_RS \
... .withColumn("Rango Salarial", regexp_replace(df_silver["Rango Salarial"], "Rango", "")) \
... .withColumn("RS compentencia", regexp_replace(df_silver["RS competencia"], "Rango", "")) \
... .withColumn("avg salario en rublos", (df_silver["sueldo en rublos desde"] + df_silver["sueldo en rublos hasta"]) / 2)
Traceback (most recent call last):
  File "<stdin>", line 2, in <module>
NameError: name 'df_silver' is not defined
>>> df_RS = df_RS \
... .withColumn("Rango Salarial", regexp_replace(df_RS["Rango Salarial"], "Rango", "")) \
... .withColumn("RS compentencia", regexp_replace(df_RS["RS competencia"], "Rango", "")) \
... .withColumn("avg salario en rublos", (df_RS["sueldo en rublos desde"] + df_RS["sueldo en rublos hasta"]) / 2)
>>> df_RS.printSchema()
root
 |-- Id: integer (nullable = true)
 |-- Nombre: string (nullable = true)
 |-- Apellido: string (nullable = true)
 |-- Area: string (nullable = true)
 |-- Fecha comienzo: date (nullable = true)
 |-- Fecha fin: date (nullable = true)
 |-- Nivel: integer (nullable = true)
 |-- Grupo recruitment: string (nullable = true)
 |-- Tiempo recruitment en semanas: integer (nullable = true)
 |-- Rango Salarial: string (nullable = true)
 |-- RS competencia: string (nullable = true)
 |-- Manager: string (nullable = true)
 |-- Realizo Cursos: string (nullable = true)
 |-- Id_Manager: string (nullable = true)
 |-- Nombre_Manager: string (nullable = true)
 |-- Apellido_Manager: string (nullable = true)
 |-- sueldo en rublos desde: string (nullable = true)
 |-- sueldo en rublos hasta: string (nullable = true)
 |-- dias_trabajados: integer (nullable = true)
 |-- RS compentencia: string (nullable = true)
 |-- avg salario en rublos: double (nullable = true)

>>> df_RS2 = df_RS \
... .withColumn("Rango Salarial", regexp_replace(df_RS["Rango Salarial"], "Rango", "")) \
... .withColumn("RS competencia", regexp_replace(df_RS["RS competecia"], "Rango", "")) \
... .withColumn("Rango Salarial", df_RS2["Rango Salarial"].cast("int")) \
... .withColumn("RS competencia", df_RS2["RS competencia"].cast("int"))
Traceback (most recent call last):
  File "<stdin>", line 3, in <module>
  File "/home/hadoop/spark/python/pyspark/sql/dataframe.py", line 1636, in __getitem__
    jc = self._jdf.apply(item)
  File "/home/hadoop/spark/python/lib/py4j-0.10.9.2-src.zip/py4j/java_gateway.py", line 1309, in __call__
  File "/home/hadoop/spark/python/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Cannot resolve column name "RS competecia" among (Id, Nombre, Apellido, Area, Fecha comienzo, Fecha fin, Nivel, Grupo recruitment, Tiempo recruitment en semanas, Rango Salarial, RS competencia, Manager, Realizo Cursos, Id_Manager, Nombre_Manager, Apellido_Manager, sueldo en rublos desde, sueldo en rublos hasta, dias_trabajados, RS compentencia, avg salario en rublos)
>>> df_RS2 = df_RS \
... .withColumn("Rango Salarial", regexp_replace(df_RS["Rango Salarial"], "Rango", "")) \
... .withColumn("Rango Salarial", df_RS2["Rango Salarial"].cast("int")) \
... .withColumn("RS competencia", regexp_replace(df_RS["RS competencia"], "Rango", "")) \
... .withColumn("RS competencia", df_RS2["RS competencia"].cast("int"))
Traceback (most recent call last):
  File "<stdin>", line 3, in <module>
NameError: name 'df_RS2' is not defined
>>> df_RS2 = df_RS \
... .withColumn("Rango Salarial", regexp_replace(df_RS["Rango Salarial"], "Rango", "")) \
... .withColumn("Rango Salarial", df_RS["Rango Salarial"].cast("int")) \
... .withColumn("Rango Salarial", df_RS["Rango Salarial"].cast("int")) \
... .withColumn("Rango Salarial", df_RS2["Rango Salarial"].cast("int")) \
... 
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/home/hadoop/spark/python/pyspark/sql/dataframe.py", line 2478, in withColumn
    return DataFrame(self._jdf.withColumn(colName, col._jc), self.sql_ctx)
  File "/home/hadoop/spark/python/lib/py4j-0.10.9.2-src.zip/py4j/java_gateway.py", line 1309, in __call__
  File "/home/hadoop/spark/python/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Resolved attribute(s) Rango Salarial#504 missing from Id#198,Nombre#17,Apellido#18,Area#19,Fecha comienzo#238,Fecha fin#218,Nivel#350,Grupo recruitment#371,Tiempo recruitment en semanas#443,Rango Salarial#611,RS competencia#26,Manager#27,Realizo Cursos#28,Id_Manager#64,Nombre_Manager#68,Apellido_Manager#72,sueldo en rublos desde#152,sueldo en rublos hasta#156,dias_trabajados#275,RS compentencia#524,avg salario en rublos#545 in operator !Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, cast(Rango Salarial#504 as int) AS Rango Salarial#633, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275, RS compentencia#524, avg salario en rublos#545]. Attribute(s) with the same name appear in the operation: Rango Salarial. Please check if the right attribute(s) are used.;
!Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, cast(Rango Salarial#504 as int) AS Rango Salarial#633, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275, RS compentencia#524, avg salario en rublos#545]
+- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, regexp_replace(Rango Salarial#504, Rango, , 1) AS Rango Salarial#611, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275, RS compentencia#524, avg salario en rublos#545]
   +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, Rango Salarial#504, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275, RS compentencia#524, ((cast(sueldo en rublos desde#152 as double) + cast(sueldo en rublos hasta#156 as double)) / cast(2 as double)) AS avg salario en rublos#545]
      +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, Rango Salarial#504, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275, regexp_replace(RS competencia#26, Rango, , 1) AS RS compentencia#524]
         +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, regexp_replace(Rango Salarial#25, Rango, , 1) AS Rango Salarial#504, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
            +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
               +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, cast(Tiempo recruitment en semanas#422 as int) AS Tiempo recruitment en semanas#443, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                  +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment#24 AS Tiempo recruitment en semanas#422, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                     +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, regexp_replace(Grupo recruitment#23, Grupo, , 1) AS Grupo recruitment#371, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                        +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, cast(Nivel#318 as int) AS Nivel#350, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                           +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, regexp_replace(Nivel#22, N, , 1) AS Nivel#318, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                              +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#22, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, datediff(Fecha fin#218, Fecha comienzo#238) AS dias_trabajados#275]
                                 +- Project [Id#198, Nombre#17, Apellido#18, Area#19, to_date(Fecha comienzo#20, Some(MM/dd/yyyy)) AS Fecha comienzo#238, Fecha fin#218, Nivel#22, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156]
                                    +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#20, to_date(Fecha fin#21, Some(MM/dd/yyyy)) AS Fecha fin#218, Nivel#22, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156]
                                       +- Project [cast(Id#16 as int) AS Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#20, Fecha fin#21, Nivel#22, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156]
                                          +- Join Inner, (Rango Salarial#25 = Rango#146)
                                             :- Join Inner, (Manager#27 = Id_Manager#64)
                                             :  :- Relation [Id#16,Nombre#17,Apellido#18,Area#19,Fecha comienzo#20,Fecha fin#21,Nivel#22,Grupo recruitment#23,Tiempo recruitment#24,Rango Salarial#25,RS competencia#26,Manager#27,Realizo Cursos#28] csv
                                             :  +- Project [Id_Manager#64, Nombre_Manager#68, Apellido#60 AS Apellido_Manager#72]
                                             :     +- Project [Id_Manager#64, Nombre#59 AS Nombre_Manager#68, Apellido#60]
                                             :        +- Project [Id#58 AS Id_Manager#64, Nombre#59, Apellido#60]
                                             :           +- Relation [Id#58,Nombre#59,Apellido#60] csv
                                             +- Project [Rango#146, sueldo en rublos desde#152, hasta#148 AS sueldo en rublos hasta#156]
                                                +- Project [Rango#146, desde#147 AS sueldo en rublos desde#152, hasta#148]
                                                   +- Relation [Rango#146,desde#147,hasta#148] csv

>>> df_RS2 = df_RS \
... .withColumn("Rango Salarial", regexp_replace(df_RS["Rango Salarial"], "Rango", "")) \
... .withColumn("Rango Salarial", df_RS["Rango Salarial"].cast("int"))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/home/hadoop/spark/python/pyspark/sql/dataframe.py", line 2478, in withColumn
    return DataFrame(self._jdf.withColumn(colName, col._jc), self.sql_ctx)
  File "/home/hadoop/spark/python/lib/py4j-0.10.9.2-src.zip/py4j/java_gateway.py", line 1309, in __call__
  File "/home/hadoop/spark/python/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Resolved attribute(s) Rango Salarial#504 missing from Id#198,Nombre#17,Apellido#18,Area#19,Fecha comienzo#238,Fecha fin#218,Nivel#350,Grupo recruitment#371,Tiempo recruitment en semanas#443,Rango Salarial#634,RS competencia#26,Manager#27,Realizo Cursos#28,Id_Manager#64,Nombre_Manager#68,Apellido_Manager#72,sueldo en rublos desde#152,sueldo en rublos hasta#156,dias_trabajados#275,RS compentencia#524,avg salario en rublos#545 in operator !Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, cast(Rango Salarial#504 as int) AS Rango Salarial#656, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275, RS compentencia#524, avg salario en rublos#545]. Attribute(s) with the same name appear in the operation: Rango Salarial. Please check if the right attribute(s) are used.;
!Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, cast(Rango Salarial#504 as int) AS Rango Salarial#656, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275, RS compentencia#524, avg salario en rublos#545]
+- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, regexp_replace(Rango Salarial#504, Rango, , 1) AS Rango Salarial#634, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275, RS compentencia#524, avg salario en rublos#545]
   +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, Rango Salarial#504, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275, RS compentencia#524, ((cast(sueldo en rublos desde#152 as double) + cast(sueldo en rublos hasta#156 as double)) / cast(2 as double)) AS avg salario en rublos#545]
      +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, Rango Salarial#504, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275, regexp_replace(RS competencia#26, Rango, , 1) AS RS compentencia#524]
         +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, regexp_replace(Rango Salarial#25, Rango, , 1) AS Rango Salarial#504, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
            +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
               +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, cast(Tiempo recruitment en semanas#422 as int) AS Tiempo recruitment en semanas#443, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                  +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment#24 AS Tiempo recruitment en semanas#422, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                     +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, regexp_replace(Grupo recruitment#23, Grupo, , 1) AS Grupo recruitment#371, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                        +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, cast(Nivel#318 as int) AS Nivel#350, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                           +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, regexp_replace(Nivel#22, N, , 1) AS Nivel#318, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                              +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#22, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, datediff(Fecha fin#218, Fecha comienzo#238) AS dias_trabajados#275]
                                 +- Project [Id#198, Nombre#17, Apellido#18, Area#19, to_date(Fecha comienzo#20, Some(MM/dd/yyyy)) AS Fecha comienzo#238, Fecha fin#218, Nivel#22, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156]
                                    +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#20, to_date(Fecha fin#21, Some(MM/dd/yyyy)) AS Fecha fin#218, Nivel#22, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156]
                                       +- Project [cast(Id#16 as int) AS Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#20, Fecha fin#21, Nivel#22, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156]
                                          +- Join Inner, (Rango Salarial#25 = Rango#146)
                                             :- Join Inner, (Manager#27 = Id_Manager#64)
                                             :  :- Relation [Id#16,Nombre#17,Apellido#18,Area#19,Fecha comienzo#20,Fecha fin#21,Nivel#22,Grupo recruitment#23,Tiempo recruitment#24,Rango Salarial#25,RS competencia#26,Manager#27,Realizo Cursos#28] csv
                                             :  +- Project [Id_Manager#64, Nombre_Manager#68, Apellido#60 AS Apellido_Manager#72]
                                             :     +- Project [Id_Manager#64, Nombre#59 AS Nombre_Manager#68, Apellido#60]
                                             :        +- Project [Id#58 AS Id_Manager#64, Nombre#59, Apellido#60]
                                             :           +- Relation [Id#58,Nombre#59,Apellido#60] csv
                                             +- Project [Rango#146, sueldo en rublos desde#152, hasta#148 AS sueldo en rublos hasta#156]
                                                +- Project [Rango#146, desde#147 AS sueldo en rublos desde#152, hasta#148]
                                                   +- Relation [Rango#146,desde#147,hasta#148] csv

>>> df_RS2 = df_RS \
... .withColumn("Rango Salarial", regexp_replace(df_RS["Rango Salarial"], "Rango", "")) 
>>> df_RS2 = df_RS \
... .withColumn("Rango Salarial", df_RS["Rango Salarial"].cast("int"))
>>> df_RS2.select('Rango Salarial').show(3)
[Stage 21:>                                                         (0 + 1                                                                          +--------------+
|Rango Salarial|
+--------------+
|             2|
|             4|
|             3|
+--------------+
only showing top 3 rows

>>> df_RS2 = df_RS2 \
... .withColumn("RS competencia", regexp_replace(df_RS2["RS competencia"], "Rango", ""))
>>> df_RS2 = df_RS2 \
... .withColumn("RS competencia", df_RS2["RS competencia"].cast("int"))
>>> df_RS2.printScema()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/home/hadoop/spark/python/pyspark/sql/dataframe.py", line 1659, in __getattr__
    raise AttributeError(
AttributeError: 'DataFrame' object has no attribute 'printScema'
>>> df_RS2.printSchema()
root
 |-- Id: integer (nullable = true)
 |-- Nombre: string (nullable = true)
 |-- Apellido: string (nullable = true)
 |-- Area: string (nullable = true)
 |-- Fecha comienzo: date (nullable = true)
 |-- Fecha fin: date (nullable = true)
 |-- Nivel: integer (nullable = true)
 |-- Grupo recruitment: string (nullable = true)
 |-- Tiempo recruitment en semanas: integer (nullable = true)
 |-- Rango Salarial: integer (nullable = true)
 |-- RS competencia: integer (nullable = true)
 |-- Manager: string (nullable = true)
 |-- Realizo Cursos: string (nullable = true)
 |-- Id_Manager: string (nullable = true)
 |-- Nombre_Manager: string (nullable = true)
 |-- Apellido_Manager: string (nullable = true)
 |-- sueldo en rublos desde: string (nullable = true)
 |-- sueldo en rublos hasta: string (nullable = true)
 |-- dias_trabajados: integer (nullable = true)
 |-- RS compentencia: string (nullable = true)
 |-- avg salario en rublos: double (nullable = true)

>>> df_RS.printSchema()
root
 |-- Id: integer (nullable = true)
 |-- Nombre: string (nullable = true)
 |-- Apellido: string (nullable = true)
 |-- Area: string (nullable = true)
 |-- Fecha comienzo: date (nullable = true)
 |-- Fecha fin: date (nullable = true)
 |-- Nivel: integer (nullable = true)
 |-- Grupo recruitment: string (nullable = true)
 |-- Tiempo recruitment en semanas: integer (nullable = true)
 |-- Rango Salarial: string (nullable = true)
 |-- RS competencia: string (nullable = true)
 |-- Manager: string (nullable = true)
 |-- Realizo Cursos: string (nullable = true)
 |-- Id_Manager: string (nullable = true)
 |-- Nombre_Manager: string (nullable = true)
 |-- Apellido_Manager: string (nullable = true)
 |-- sueldo en rublos desde: string (nullable = true)
 |-- sueldo en rublos hasta: string (nullable = true)
 |-- dias_trabajados: integer (nullable = true)
 |-- RS compentencia: string (nullable = true)
 |-- avg salario en rublos: double (nullable = true)

>>> df_RS = df_silverTR.drop('Rango')
>>> df_RS2 = df_RS /
  File "<stdin>", line 1
    df_RS2 = df_RS /
                   ^
SyntaxError: invalid syntax
>>> df_RS2 = df_RS \
... .withColumn("Rango Salarial", regexp_replace(df_RS["Rango Salarial"], "Rango", "")) \
... .withColumn("RS competencia", regexp_replace(df_RS["RS competecia"], "Rango", ""))
Traceback (most recent call last):
  File "<stdin>", line 3, in <module>
  File "/home/hadoop/spark/python/pyspark/sql/dataframe.py", line 1636, in __getitem__
    jc = self._jdf.apply(item)
  File "/home/hadoop/spark/python/lib/py4j-0.10.9.2-src.zip/py4j/java_gateway.py", line 1309, in __call__
  File "/home/hadoop/spark/python/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Cannot resolve column name "RS competecia" among (Id, Nombre, Apellido, Area, Fecha comienzo, Fecha fin, Nivel, Grupo recruitment, Tiempo recruitment en semanas, Rango Salarial, RS competencia, Manager, Realizo Cursos, Id_Manager, Nombre_Manager, Apellido_Manager, sueldo en rublos desde, sueldo en rublos hasta, dias_trabajados)
>>> df_RS2 = df_RS \
... .withColumn("Rango Salarial", regexp_replace(df_RS["Rango Salarial"], "Rango", "")) \
... .withColumn("RS competencia", regexp_replace(df_RS["RS compentecia"], "Rango", ""))
Traceback (most recent call last):
  File "<stdin>", line 3, in <module>
  File "/home/hadoop/spark/python/pyspark/sql/dataframe.py", line 1636, in __getitem__
    jc = self._jdf.apply(item)
  File "/home/hadoop/spark/python/lib/py4j-0.10.9.2-src.zip/py4j/java_gateway.py", line 1309, in __call__
  File "/home/hadoop/spark/python/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Cannot resolve column name "RS compentecia" among (Id, Nombre, Apellido, Area, Fecha comienzo, Fecha fin, Nivel, Grupo recruitment, Tiempo recruitment en semanas, Rango Salarial, RS competencia, Manager, Realizo Cursos, Id_Manager, Nombre_Manager, Apellido_Manager, sueldo en rublos desde, sueldo en rublos hasta, dias_trabajados)
>>> .withColumn("Rango Salarial", regexp_replace(df_RS["Rango Salarial"], "Rango", "")) \
  File "<stdin>", line 1
    .withColumn("Rango Salarial", regexp_replace(df_RS["Rango Salarial"], "Rango", "")) \
    ^
SyntaxError: invalid syntax
>>> df_RS2 = df_RS \
... .withColumn("Rango Salarial", regexp_replace(df_RS["Rango Salarial"], "Rango", "")) \
... .withColumn("RS competencia", regexp_replace(df_RS["RS compentecia"], "Rango", ""))
Traceback (most recent call last):
  File "<stdin>", line 3, in <module>
  File "/home/hadoop/spark/python/pyspark/sql/dataframe.py", line 1636, in __getitem__
    jc = self._jdf.apply(item)
  File "/home/hadoop/spark/python/lib/py4j-0.10.9.2-src.zip/py4j/java_gateway.py", line 1309, in __call__
  File "/home/hadoop/spark/python/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Cannot resolve column name "RS compentecia" among (Id, Nombre, Apellido, Area, Fecha comienzo, Fecha fin, Nivel, Grupo recruitment, Tiempo recruitment en semanas, Rango Salarial, RS competencia, Manager, Realizo Cursos, Id_Manager, Nombre_Manager, Apellido_Manager, sueldo en rublos desde, sueldo en rublos hasta, dias_trabajados)
>>> df_RS2 = df_RS.withColumn("RS competencia", regexp_replace(df_RS["RS compentecia"], "Rango", ""))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/home/hadoop/spark/python/pyspark/sql/dataframe.py", line 1636, in __getitem__
    jc = self._jdf.apply(item)
  File "/home/hadoop/spark/python/lib/py4j-0.10.9.2-src.zip/py4j/java_gateway.py", line 1309, in __call__
  File "/home/hadoop/spark/python/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Cannot resolve column name "RS compentecia" among (Id, Nombre, Apellido, Area, Fecha comienzo, Fecha fin, Nivel, Grupo recruitment, Tiempo recruitment en semanas, Rango Salarial, RS competencia, Manager, Realizo Cursos, Id_Manager, Nombre_Manager, Apellido_Manager, sueldo en rublos desde, sueldo en rublos hasta, dias_trabajados)
>>> RS.select('RS competencia').show(4)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'RS' is not defined
>>> df_RS.select('RS competencia').show(4)
+--------------+
|RS competencia|
+--------------+
|       Rango 2|
|       Rango 4|
|       Rango 3|
|       Rango 3|
+--------------+
only showing top 4 rows

>>> df_RS.select('Rango Salarial').show(4)
+--------------+
|Rango Salarial|
+--------------+
|       Rango 2|
|       Rango 4|
|       Rango 3|
|       Rango 3|
+--------------+
only showing top 4 rows

>>> df_RS2 = df_RS \
... .withColumn("Rango Salarial", regexp_replace(df_RS["Rango Salarial"], "Rango", ""))
>>> df_RS2 = df_RS \
... .withColumn("RS compentecia", regexp_replace(df_RS["RS compentecia"], "Rango", ""))
Traceback (most recent call last):
  File "<stdin>", line 2, in <module>
  File "/home/hadoop/spark/python/pyspark/sql/dataframe.py", line 1636, in __getitem__
    jc = self._jdf.apply(item)
  File "/home/hadoop/spark/python/lib/py4j-0.10.9.2-src.zip/py4j/java_gateway.py", line 1309, in __call__
  File "/home/hadoop/spark/python/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Cannot resolve column name "RS compentecia" among (Id, Nombre, Apellido, Area, Fecha comienzo, Fecha fin, Nivel, Grupo recruitment, Tiempo recruitment en semanas, Rango Salarial, RS competencia, Manager, Realizo Cursos, Id_Manager, Nombre_Manager, Apellido_Manager, sueldo en rublos desde, sueldo en rublos hasta, dias_trabajados)
>>> df_RS2 = df_RS2 \
... .withColumn("RS compentecia", regexp_replace(df_RS["RS compentecia"], "Rango", ""))
Traceback (most recent call last):
  File "<stdin>", line 2, in <module>
  File "/home/hadoop/spark/python/pyspark/sql/dataframe.py", line 1636, in __getitem__
    jc = self._jdf.apply(item)
  File "/home/hadoop/spark/python/lib/py4j-0.10.9.2-src.zip/py4j/java_gateway.py", line 1309, in __call__
  File "/home/hadoop/spark/python/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Cannot resolve column name "RS compentecia" among (Id, Nombre, Apellido, Area, Fecha comienzo, Fecha fin, Nivel, Grupo recruitment, Tiempo recruitment en semanas, Rango Salarial, RS competencia, Manager, Realizo Cursos, Id_Manager, Nombre_Manager, Apellido_Manager, sueldo en rublos desde, sueldo en rublos hasta, dias_trabajados)
>>> df_RS2 = df_RS2 \
... .withColumn("RS compentecia", regexp_replace(df_RS["RS compentencia"], "Rango", ""))
Traceback (most recent call last):
  File "<stdin>", line 2, in <module>
  File "/home/hadoop/spark/python/pyspark/sql/dataframe.py", line 1636, in __getitem__
    jc = self._jdf.apply(item)
  File "/home/hadoop/spark/python/lib/py4j-0.10.9.2-src.zip/py4j/java_gateway.py", line 1309, in __call__
  File "/home/hadoop/spark/python/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Cannot resolve column name "RS compentencia" among (Id, Nombre, Apellido, Area, Fecha comienzo, Fecha fin, Nivel, Grupo recruitment, Tiempo recruitment en semanas, Rango Salarial, RS competencia, Manager, Realizo Cursos, Id_Manager, Nombre_Manager, Apellido_Manager, sueldo en rublos desde, sueldo en rublos hasta, dias_trabajados)
>>> df_RS2 = df_RS2 \
... .withColumn("RS compentencia", regexp_replace(df_RS["RS compentencia"], "Rango", ""))
Traceback (most recent call last):
  File "<stdin>", line 2, in <module>
  File "/home/hadoop/spark/python/pyspark/sql/dataframe.py", line 1636, in __getitem__
    jc = self._jdf.apply(item)
  File "/home/hadoop/spark/python/lib/py4j-0.10.9.2-src.zip/py4j/java_gateway.py", line 1309, in __call__
  File "/home/hadoop/spark/python/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Cannot resolve column name "RS compentencia" among (Id, Nombre, Apellido, Area, Fecha comienzo, Fecha fin, Nivel, Grupo recruitment, Tiempo recruitment en semanas, Rango Salarial, RS competencia, Manager, Realizo Cursos, Id_Manager, Nombre_Manager, Apellido_Manager, sueldo en rublos desde, sueldo en rublos hasta, dias_trabajados)
>>> df_RS2 = df_RS2 \
... .withColumn("RS competencia", regexp_replace(df_RS2["RS competencia"], "Rango", ""))
>>> df_RS2 = df_RS2 \
... .withColumn("Rango Salarial", df_RS["Rango Salarial"].cast("int")) \
... .withColumn("RS competencia", df_RS2["RS competencia"].cast("int")) 
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/home/hadoop/spark/python/pyspark/sql/dataframe.py", line 2478, in withColumn
    return DataFrame(self._jdf.withColumn(colName, col._jc), self.sql_ctx)
  File "/home/hadoop/spark/python/lib/py4j-0.10.9.2-src.zip/py4j/java_gateway.py", line 1309, in __call__
  File "/home/hadoop/spark/python/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Resolved attribute(s) Rango Salarial#25 missing from Id#198,Nombre#17,Apellido#18,Area#19,Fecha comienzo#238,Fecha fin#218,Nivel#350,Grupo recruitment#371,Tiempo recruitment en semanas#443,Rango Salarial#855,RS competencia#875,Manager#27,Realizo Cursos#28,Id_Manager#64,Nombre_Manager#68,Apellido_Manager#72,sueldo en rublos desde#152,sueldo en rublos hasta#156,dias_trabajados#275 in operator !Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, cast(Rango Salarial#25 as int) AS Rango Salarial#895, RS competencia#875, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]. Attribute(s) with the same name appear in the operation: Rango Salarial. Please check if the right attribute(s) are used.;
!Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, cast(Rango Salarial#25 as int) AS Rango Salarial#895, RS competencia#875, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
+- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, Rango Salarial#855, regexp_replace(RS competencia#26, Rango, , 1) AS RS competencia#875, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
   +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, regexp_replace(Rango Salarial#25, Rango, , 1) AS Rango Salarial#855, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
      +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
         +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, cast(Tiempo recruitment en semanas#422 as int) AS Tiempo recruitment en semanas#443, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
            +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment#24 AS Tiempo recruitment en semanas#422, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
               +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, regexp_replace(Grupo recruitment#23, Grupo, , 1) AS Grupo recruitment#371, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                  +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, cast(Nivel#318 as int) AS Nivel#350, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                     +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, regexp_replace(Nivel#22, N, , 1) AS Nivel#318, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                        +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#22, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, datediff(Fecha fin#218, Fecha comienzo#238) AS dias_trabajados#275]
                           +- Project [Id#198, Nombre#17, Apellido#18, Area#19, to_date(Fecha comienzo#20, Some(MM/dd/yyyy)) AS Fecha comienzo#238, Fecha fin#218, Nivel#22, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156]
                              +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#20, to_date(Fecha fin#21, Some(MM/dd/yyyy)) AS Fecha fin#218, Nivel#22, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156]
                                 +- Project [cast(Id#16 as int) AS Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#20, Fecha fin#21, Nivel#22, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156]
                                    +- Join Inner, (Rango Salarial#25 = Rango#146)
                                       :- Join Inner, (Manager#27 = Id_Manager#64)
                                       :  :- Relation [Id#16,Nombre#17,Apellido#18,Area#19,Fecha comienzo#20,Fecha fin#21,Nivel#22,Grupo recruitment#23,Tiempo recruitment#24,Rango Salarial#25,RS competencia#26,Manager#27,Realizo Cursos#28] csv
                                       :  +- Project [Id_Manager#64, Nombre_Manager#68, Apellido#60 AS Apellido_Manager#72]
                                       :     +- Project [Id_Manager#64, Nombre#59 AS Nombre_Manager#68, Apellido#60]
                                       :        +- Project [Id#58 AS Id_Manager#64, Nombre#59, Apellido#60]
                                       :           +- Relation [Id#58,Nombre#59,Apellido#60] csv
                                       +- Project [Rango#146, sueldo en rublos desde#152, hasta#148 AS sueldo en rublos hasta#156]
                                          +- Project [Rango#146, desde#147 AS sueldo en rublos desde#152, hasta#148]
                                             +- Relation [Rango#146,desde#147,hasta#148] csv

>>> df_RS2 = df_RS2 \
... .withColumn("Rango Salarial", df_RS2["Rango Salarial"].cast("int")) \
... .withColumn("RS competencia", df_RS2["RS competencia"].cast("int")) 
>>> df_RS2.printSchema()
root
 |-- Id: integer (nullable = true)
 |-- Nombre: string (nullable = true)
 |-- Apellido: string (nullable = true)
 |-- Area: string (nullable = true)
 |-- Fecha comienzo: date (nullable = true)
 |-- Fecha fin: date (nullable = true)
 |-- Nivel: integer (nullable = true)
 |-- Grupo recruitment: string (nullable = true)
 |-- Tiempo recruitment en semanas: integer (nullable = true)
 |-- Rango Salarial: integer (nullable = true)
 |-- RS competencia: integer (nullable = true)
 |-- Manager: string (nullable = true)
 |-- Realizo Cursos: string (nullable = true)
 |-- Id_Manager: string (nullable = true)
 |-- Nombre_Manager: string (nullable = true)
 |-- Apellido_Manager: string (nullable = true)
 |-- sueldo en rublos desde: string (nullable = true)
 |-- sueldo en rublos hasta: string (nullable = true)
 |-- dias_trabajados: integer (nullable = true)

>>> df_RS2.select(['sueldo en rublos desde', 'sueldo en rublos hasta']).show(4)
+----------------------+----------------------+
|sueldo en rublos desde|sueldo en rublos hasta|
+----------------------+----------------------+
|                200001|                250000|
|                300001|                350000|
|                250001|                300000|
|                250001|                300000|
+----------------------+----------------------+
only showing top 4 rows

>>> df_RS3 = df_RS2 \
... .withColumn("sueldo en rublos desde", df_RS2["sueldo en rublos desde"].cast("int")) \
... .withColumn("sueldo en rublos hasta", df_RS2["sueldo en rublos hasta"].cast("int"))
>>> df_RS4 = df_RS3.withColumn("avg salario en rublos", (df_RS["sueldo en rublos desde"] + df_RS["sueldo en rublos hasta"]) / 2)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/home/hadoop/spark/python/pyspark/sql/dataframe.py", line 2478, in withColumn
    return DataFrame(self._jdf.withColumn(colName, col._jc), self.sql_ctx)
  File "/home/hadoop/spark/python/lib/py4j-0.10.9.2-src.zip/py4j/java_gateway.py", line 1309, in __call__
  File "/home/hadoop/spark/python/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Resolved attribute(s) sueldo en rublos desde#152,sueldo en rublos hasta#156 missing from Id#198,Nombre#17,Apellido#18,Area#19,Fecha comienzo#238,Fecha fin#218,Nivel#350,Grupo recruitment#371,Tiempo recruitment en semanas#443,Rango Salarial#896,RS competencia#916,Manager#27,Realizo Cursos#28,Id_Manager#64,Nombre_Manager#68,Apellido_Manager#72,sueldo en rublos desde#953,sueldo en rublos hasta#973,dias_trabajados#275 in operator !Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, Rango Salarial#896, RS competencia#916, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#953, sueldo en rublos hasta#973, dias_trabajados#275, ((cast(sueldo en rublos desde#152 as double) + cast(sueldo en rublos hasta#156 as double)) / cast(2 as double)) AS avg salario en rublos#993]. Attribute(s) with the same name appear in the operation: sueldo en rublos desde,sueldo en rublos hasta. Please check if the right attribute(s) are used.;
!Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, Rango Salarial#896, RS competencia#916, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#953, sueldo en rublos hasta#973, dias_trabajados#275, ((cast(sueldo en rublos desde#152 as double) + cast(sueldo en rublos hasta#156 as double)) / cast(2 as double)) AS avg salario en rublos#993]
+- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, Rango Salarial#896, RS competencia#916, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#953, cast(sueldo en rublos hasta#156 as int) AS sueldo en rublos hasta#973, dias_trabajados#275]
   +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, Rango Salarial#896, RS competencia#916, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, cast(sueldo en rublos desde#152 as int) AS sueldo en rublos desde#953, sueldo en rublos hasta#156, dias_trabajados#275]
      +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, Rango Salarial#896, cast(RS competencia#875 as int) AS RS competencia#916, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
         +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, cast(Rango Salarial#855 as int) AS Rango Salarial#896, RS competencia#875, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
            +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, Rango Salarial#855, regexp_replace(RS competencia#26, Rango, , 1) AS RS competencia#875, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
               +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, regexp_replace(Rango Salarial#25, Rango, , 1) AS Rango Salarial#855, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                  +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment en semanas#443, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                     +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, cast(Tiempo recruitment en semanas#422 as int) AS Tiempo recruitment en semanas#443, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                        +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, Grupo recruitment#371, Tiempo recruitment#24 AS Tiempo recruitment en semanas#422, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                           +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#350, regexp_replace(Grupo recruitment#23, Grupo, , 1) AS Grupo recruitment#371, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                              +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, cast(Nivel#318 as int) AS Nivel#350, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                                 +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, regexp_replace(Nivel#22, N, , 1) AS Nivel#318, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, dias_trabajados#275]
                                    +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#238, Fecha fin#218, Nivel#22, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156, datediff(Fecha fin#218, Fecha comienzo#238) AS dias_trabajados#275]
                                       +- Project [Id#198, Nombre#17, Apellido#18, Area#19, to_date(Fecha comienzo#20, Some(MM/dd/yyyy)) AS Fecha comienzo#238, Fecha fin#218, Nivel#22, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156]
                                          +- Project [Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#20, to_date(Fecha fin#21, Some(MM/dd/yyyy)) AS Fecha fin#218, Nivel#22, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156]
                                             +- Project [cast(Id#16 as int) AS Id#198, Nombre#17, Apellido#18, Area#19, Fecha comienzo#20, Fecha fin#21, Nivel#22, Grupo recruitment#23, Tiempo recruitment#24, Rango Salarial#25, RS competencia#26, Manager#27, Realizo Cursos#28, Id_Manager#64, Nombre_Manager#68, Apellido_Manager#72, Rango#146, sueldo en rublos desde#152, sueldo en rublos hasta#156]
                                                +- Join Inner, (Rango Salarial#25 = Rango#146)
                                                   :- Join Inner, (Manager#27 = Id_Manager#64)
                                                   :  :- Relation [Id#16,Nombre#17,Apellido#18,Area#19,Fecha comienzo#20,Fecha fin#21,Nivel#22,Grupo recruitment#23,Tiempo recruitment#24,Rango Salarial#25,RS competencia#26,Manager#27,Realizo Cursos#28] csv
                                                   :  +- Project [Id_Manager#64, Nombre_Manager#68, Apellido#60 AS Apellido_Manager#72]
                                                   :     +- Project [Id_Manager#64, Nombre#59 AS Nombre_Manager#68, Apellido#60]
                                                   :        +- Project [Id#58 AS Id_Manager#64, Nombre#59, Apellido#60]
                                                   :           +- Relation [Id#58,Nombre#59,Apellido#60] csv
                                                   +- Project [Rango#146, sueldo en rublos desde#152, hasta#148 AS sueldo en rublos hasta#156]
                                                      +- Project [Rango#146, desde#147 AS sueldo en rublos desde#152, hasta#148]
                                                         +- Relation [Rango#146,desde#147,hasta#148] csv

>>> df_RS4 =df_RS4 \
... .withColumn("avg salario en rublos", (df_RS["sueldo en rublos desde"] + df_RS["sueldo en rublos hasta"]) / 2)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'df_RS4' is not defined
>>> df_RS4 = df_RS3.withColumn("avg salario en rublos", (df_RS3["sueldo en rublos desde"] + df_RS3["sueldo en rublos hasta"]) / 2)
>>> df_RS4.printSchema()
root
 |-- Id: integer (nullable = true)
 |-- Nombre: string (nullable = true)
 |-- Apellido: string (nullable = true)
 |-- Area: string (nullable = true)
 |-- Fecha comienzo: date (nullable = true)
 |-- Fecha fin: date (nullable = true)
 |-- Nivel: integer (nullable = true)
 |-- Grupo recruitment: string (nullable = true)
 |-- Tiempo recruitment en semanas: integer (nullable = true)
 |-- Rango Salarial: integer (nullable = true)
 |-- RS competencia: integer (nullable = true)
 |-- Manager: string (nullable = true)
 |-- Realizo Cursos: string (nullable = true)
 |-- Id_Manager: string (nullable = true)
 |-- Nombre_Manager: string (nullable = true)
 |-- Apellido_Manager: string (nullable = true)
 |-- sueldo en rublos desde: integer (nullable = true)
 |-- sueldo en rublos hasta: integer (nullable = true)
 |-- dias_trabajados: integer (nullable = true)
 |-- avg salario en rublos: double (nullable = true)

>>> df_silver = df_RS4
>>> df_silver.select('Grupo recruitment').distinct().collect().show()
[Stage 31:>                                                         (0 + 1                                                                          [Stage 33:>                                                         (0 + 1[Stage 35:>                                                         (0 + 1                                                                          Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'list' object has no attribute 'show'
>>> df_silver.select('Grupo recruitment').show()
[Stage 38:>                                                         (0 + 1                                                                          +-----------------+
|Grupo recruitment|
+-----------------+
|                A|
|                A|
|                A|
|                A|
|                A|
|                A|
|                A|
|                A|
|                A|
|                A|
|                A|
|                B|
|                B|
|                B|
|                B|
|                B|
|                B|
|                B|
|                B|
|                C|
+-----------------+
only showing top 20 rows

>>> filtered_df = df_silver.filter(df_silver['Grupo recruitment'].isin('d', 'e'))
>>> filtered_df.show()
[Stage 41:>                                                         (0 + 1                                                                          +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> filtered_df = df_silver.filter(df_silver['Grupo recruitment'].isin('c'))
>>> filtered_df.show()
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> filtered_df = df_silver.filter(df_silver['Grupo recruitment'].isin('C'))
>>> filtered_df.show()
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> filtered_df = df_silver.where((df_silver['Grupo recruitment'] == 'C')
... )
>>> filtered_df.show()
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> filtered_df = df_silver.where((df_silver['Grupo recruitment'] == 'A')
... )
>>> filtered_df.show(5)
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> from pyspark.sql.functions import col
>>> 
>>> # Find unique values in the 'Grupo recruitment' column
>>> unique_values = df_silver.select('Grupo recruitment').distinct().rdd.map(lambda row: row[0]).collect()
[Stage 56:>                                                  [Stage 58:>                                                                                                               >>>                
>>> # Create an empty list to store DataFrames
>>> dfs_per_value = []
>>> 
>>> # Loop over unique values and filter DataFrame for each value
>>> for value in unique_values:
...     # Filter DataFrame for the current value
...     filtered_df = df_silver.where(col('Grupo recruitment') == value)
...     
...     # Append filtered DataFrame to the list
...     dfs_per_value.append(filtered_df)
... 
>>> # Show the list of DataFrames
>>> for idx, df in enumerate(dfs_per_value, start=1):
...     print(f"DataFrame for unique value '{unique_values[idx - 1]}':")
...     df.show()
... 
DataFrame for unique value ' C':
+---+--------+---------+---------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|  Nombre| Apellido|     Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+--------+---------+---------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
|  3|    Juan| Albornoz|       IT|    2018-06-04|2019-04-30|    4|                C|                            4|             4|             4|      5|            NO|         5|     Alejandro|        Pitorino|                300001|                350000|            330|             325000.5|
|  5|  Franco|Rodrguez|Marketing|    2017-05-01|2017-11-30|    5|                C|                            6|             5|             4|      1|            SI|         1|       Rolando|           Casas|                350001|                400000|            213|             375000.5|
|  9| Nicolas| Martnez|       IT|    2021-01-04|2021-11-30|    2|                C|                            6|             3|             3|      5|            SI|         5|     Alejandro|        Pitorino|                250001|                300000|            330|             275000.5|
| 12|    Luis|  Snchez|   Ventas|    2020-07-13|2020-12-31|    5|                C|                            5|             6|             6|      8|            NO|         8|       Ricardo|         Ronaldo|                400001|                500000|            171|             450000.5|
| 14|    Raul|   Garca|   Ventas|    2019-02-04|2020-03-31|    3|                C|                            6|             3|             3|      8|            SI|         8|       Ricardo|         Ronaldo|                250001|                300000|            421|             275000.5|
| 16|  Vanina|  Bentez|       IT|    2019-08-05|2020-04-30|    5|                C|                            5|             6|             6|      5|            SI|         5|     Alejandro|        Pitorino|                400001|                500000|            269|             450000.5|
| 20| Marcelo|   Flores|   Ventas|    2021-09-06|2022-05-31|    2|                C|                            6|             2|             2|      8|            SI|         8|       Ricardo|         Ronaldo|                200001|                250000|            267|             225000.5|
| 21|Cristian|   Martin|  Compras|    2017-11-06|2020-12-31|    5|                C|                            4|             6|             5|      2|            SI|         2|        Marina|          Pitana|                400001|                500000|           1151|             450000.5|
| 23|  Camila|   Prieto|       IT|    2022-01-03|2022-07-01|    6|                C|                            6|             6|             6|      5|            NO|         5|     Alejandro|        Pitorino|                400001|                500000|            179|             450000.5|
| 29|   Dante|  Martini|       IT|    2021-03-01|2021-12-31|    4|                C|                            6|             3|             3|      5|            NO|         5|     Alejandro|        Pitorino|                250001|                300000|            305|             275000.5|
| 30|   Diego|    Buzos|Auditoria|    2021-09-06|2022-06-30|    1|                C|                            3|             1|             1|     10|            SI|        10|        Daniel|         Quiroga|                150000|                200000|            297|             175000.0|
+---+--------+---------+---------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

DataFrame for unique value ' B':
+---+--------+--------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|  Nombre|Apellido|      Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+--------+--------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
|  1|  Romina|   Brito| Marketing|    2018-03-05|2018-12-31|    3|                B|                            3|             3|             3|      1|            SI|         1|       Rolando|           Casas|                250001|                300000|            301|             275000.5|
|  2|   Pedro|   Lujan|   Compras|    2017-03-06|2021-12-31|    3|                B|                            3|             2|             2|      2|            SI|         2|        Marina|          Pitana|                200001|                250000|           1761|             225000.5|
|  6|Catalina|   Gmez|Produccin|    2019-04-01|2022-03-31|    2|                B|                            4|             2|             2|      4|            NO|         4|        Miriam|          Pisani|                200001|                250000|           1095|             225000.5|
| 11| Roberto|   Prez| Marketing|    2019-07-01|2022-04-30|    5|                B|                            5|             5|             5|      9|            SI|         9|        Vanina|        Quintana|                350001|                400000|           1034|             375000.5|
| 18|   Pedro|  Torres| Marketing|    2017-04-03|2019-12-31|    3|                B|                            4|             3|             3|      9|            SI|         9|        Vanina|        Quintana|                250001|                300000|           1002|             275000.5|
| 22|  Matias| Bosques|    Ventas|    2018-12-03|2021-06-30|    4|                B|                            3|             4|             4|      8|            SI|         8|       Ricardo|         Ronaldo|                300001|                350000|            940|             325000.5|
| 25|Carolina|Petersen|    Ventas|    2021-07-05|2022-02-28|    7|                B|                            4|             6|             6|      8|            SI|         8|       Ricardo|         Ronaldo|                400001|                500000|            238|             450000.5|
| 26|  Fabian|  Quiroz|Produccin|    2018-05-07|2021-09-30|    3|                B|                            3|             2|             3|      6|            SI|         6|         Sonia|        Kamlasky|                200001|                250000|           1242|             225000.5|
+---+--------+--------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

DataFrame for unique value ' A':
+---+---------+---------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|   Nombre| Apellido|      Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+---------+---------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
|  4|Sebastian| Gonzlez|   Legales|    2018-05-07|2021-05-30|    2|                A|                            4|             2|             2|      3|            SI|         3|          Jos|        Feligres|                200001|                250000|           1119|             225000.5|
|  7| Anabella|Fernndez|    Ventas|    2020-07-06|2021-03-31|    4|                A|                            3|             4|             4|      8|            NO|         8|       Ricardo|         Ronaldo|                300001|                350000|            268|             325000.5|
|  8|Francesca|    Lpez|   Compras|    2017-01-02|2021-06-30|    3|                A|                            4|             3|             3|      2|            SI|         2|        Marina|          Pitana|                250001|                300000|           1640|             275000.5|
| 10|      Ana|     Diaz|        IT|    2017-03-06|2020-11-30|    4|                A|                            3|             3|             3|      7|            NO|         7|        Martn|          Viglia|                250001|                300000|           1365|             275000.5|
| 13|Alejandro|   Romero|        IT|    2020-06-01|2022-02-28|    3|                A|                            3|             4|             3|      7|            SI|         7|        Martn|          Viglia|                300001|                350000|            637|             325000.5|
| 15|   Analia|     Sosa|   Compras|    2018-10-01|2021-11-30|    4|                A|                            4|             4|             4|      2|            NO|         2|        Marina|          Pitana|                300001|                350000|           1156|             325000.5|
| 17|Guillermo|  Ramrez|        IT|    2020-01-06|2022-05-31|    2|                A|                            3|             2|             2|      7|            NO|         7|        Martn|          Viglia|                200001|                250000|            876|             225000.5|
| 19|    Rocio|     Ruiz| Auditoria|    2018-02-05|2021-01-30|    4|                A|                            4|             4|             5|     10|            NO|        10|        Daniel|         Quiroga|                300001|                350000|           1090|             325000.5|
| 24|  Micaela|    Pauls|Produccin|    2019-01-07|2021-12-31|    6|                A|                            5|             6|             6|      4|            SI|         4|        Miriam|          Pisani|                400001|                500000|           1089|             450000.5|
| 27|  Rodrigo|  Molinas|   Compras|    2019-06-03|2022-04-30|    2|                A|                            4|             2|             2|      2|            SI|         2|        Marina|          Pitana|                200001|                250000|           1062|             225000.5|
| 28|  Martina| Oliviera|Produccin|    2020-01-06|2022-06-30|    7|                A|                            4|             6|             6|      6|            SI|         6|         Sonia|        Kamlasky|                400001|                500000|            906|             450000.5|
+---+---------+---------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> from pyspark.sql.functions import col
>>> 
>>> # Filter DataFrame for each unique value
>>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
>>> grupoB = df_silver.where(col('Grupo recruitment') == 'B')
>>> grupoC = df_silver.where(col('Grupo recruitment') == 'C')
>>> 
>>> # Show the DataFrames
>>> print("DataFrame for unique value 'A':")
DataFrame for unique value 'A':
>>> grupoA.show()
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> 
>>> print("DataFrame for unique value 'B':")
DataFrame for unique value 'B':
>>> grupoB.show()
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> 
>>> print("DataFrame for unique value 'C':")
DataFrame for unique value 'C':
>>> grupoC.show()
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> grupoA = df_silver.where(col('Grupo recruitment') == A)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'A' is not defined
>>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
>>> grupoA.show(3)
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> distinct_values_A = df_silver.where(col('Grupo recruitment') == 'A').select('Grupo recruitment').distinct()
>>> distinct_values_A.show(5)
+-----------------+
|Grupo recruitment|
+-----------------+
+-----------------+

>>> df_silver.show(3)
+---+---------+---------+-------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|   Nombre| Apellido|   Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+---------+---------+-------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
|  4|Sebastian| Gonzlez|Legales|    2018-05-07|2021-05-30|    2|                A|                            4|             2|             2|      3|            SI|         3|          Jos|        Feligres|                200001|                250000|           1119|             225000.5|
|  7| Anabella|Fernndez| Ventas|    2020-07-06|2021-03-31|    4|                A|                            3|             4|             4|      8|            NO|         8|       Ricardo|         Ronaldo|                300001|                350000|            268|             325000.5|
|  8|Francesca|    Lpez|Compras|    2017-01-02|2021-06-30|    3|                A|                            4|             3|             3|      2|            SI|         2|        Marina|          Pitana|                250001|                300000|           1640|             275000.5|
+---+---------+---------+-------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
only showing top 3 rows

>>> df_silver.select('Grupo recruitment').show(3)
+-----------------+                                                             
|Grupo recruitment|
+-----------------+
|                A|
|                A|
|                A|
+-----------------+
only showing top 3 rows

>>> print("Number of rows in DataFrame for unique value 'A':", grupoA.count())
Number of rows in DataFrame for unique value 'A': 0                             
>>> df_silver.createOrReplaceTempView("silver_view")
>>> grupoA = spark.sql("SELECT * FROM silver_view WHERE `Grupo recruitment` = 'A'")
>>> grupoA.show()
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> df_silver.select('Grupo recruitment').show(3)
+-----------------+
|Grupo recruitment|
+-----------------+
|                A|
|                A|
|                A|
+-----------------+
only showing top 3 rows

>>> df_silver.printSchema()
root
 |-- Id: integer (nullable = true)
 |-- Nombre: string (nullable = true)
 |-- Apellido: string (nullable = true)
 |-- Area: string (nullable = true)
 |-- Fecha comienzo: date (nullable = true)
 |-- Fecha fin: date (nullable = true)
 |-- Nivel: integer (nullable = true)
 |-- Grupo recruitment: string (nullable = true)
 |-- Tiempo recruitment en semanas: integer (nullable = true)
 |-- Rango Salarial: integer (nullable = true)
 |-- RS competencia: integer (nullable = true)
 |-- Manager: string (nullable = true)
 |-- Realizo Cursos: string (nullable = true)
 |-- Id_Manager: string (nullable = true)
 |-- Nombre_Manager: string (nullable = true)
 |-- Apellido_Manager: string (nullable = true)
 |-- sueldo en rublos desde: integer (nullable = true)
 |-- sueldo en rublos hasta: integer (nullable = true)
 |-- dias_trabajados: integer (nullable = true)
 |-- avg salario en rublos: double (nullable = true)

>>> df_silver.filter(df_silver['Grupo recruitment'] == 'A').show()

+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> 
>>> df_silver.columns
['Id', 'Nombre', 'Apellido', 'Area', 'Fecha comienzo', 'Fecha fin', 'Nivel', 'Grupo recruitment', 'Tiempo recruitment en semanas', 'Rango Salarial', 'RS competencia', 'Manager', 'Realizo Cursos', 'Id_Manager', 'Nombre_Manager', 'Apellido_Manager', 'sueldo en rublos desde', 'sueldo en rublos hasta', 'dias_trabajados', 'avg salario en rublos']
>>> grupoA = spark.sql("SELECT * FROM silver_view WHERE `Grupo recruitment` = 'A'")
>>> grupoA.show(5)
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> 
>>> >>> filtered_df = df_silver.filter(df_silver['Grupo recruitment'].isin('C'))
  File "<stdin>", line 1
    >>> filtered_df = df_silver.filter(df_silver['Grupo recruitment'].isin('C'))
    ^
SyntaxError: invalid syntax
>>> >>> filtered_df.show()
  File "<stdin>", line 1
    >>> filtered_df.show()
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> filtered_df = df_silver.where((df_silver['Grupo recruitment'] == 'C')
  File "<stdin>", line 1
    >>> filtered_df = df_silver.where((df_silver['Grupo recruitment'] == 'C')
    ^
SyntaxError: invalid syntax
>>> ... )
  File "<stdin>", line 1
    ... )
        ^
SyntaxError: unmatched ')'
>>> >>> filtered_df.show()
  File "<stdin>", line 1
    >>> filtered_df.show()
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> filtered_df = df_silver.where((df_silver['Grupo recruitment'] == 'A')
  File "<stdin>", line 1
    >>> filtered_df = df_silver.where((df_silver['Grupo recruitment'] == 'A')
    ^
SyntaxError: invalid syntax
>>> ... )
  File "<stdin>", line 1
    ... )
        ^
SyntaxError: unmatched ')'
>>> >>> filtered_df.show(5)
  File "<stdin>", line 1
    >>> filtered_df.show(5)
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> from pyspark.sql.functions import col
  File "<stdin>", line 1
    >>> from pyspark.sql.functions import col
    ^
SyntaxError: invalid syntax
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> # Find unique values in the 'Grupo recruitment' column
  File "<stdin>", line 1
    >>> # Find unique values in the 'Grupo recruitment' column
    ^
SyntaxError: invalid syntax
>>> >>> unique_values = df_silver.select('Grupo recruitment').distinct().rdd.map(lambda row: row[0]).collect()
  File "<stdin>", line 1
    >>> unique_values = df_silver.select('Grupo recruitment').distinct().rdd.map(lambda row: row[0]).collect()
    ^
SyntaxError: invalid syntax
>>> [Stage 56:>                                                  [Stage 58:>                                                                                                               >>>                
  File "<stdin>", line 1
    [Stage 56:>                                                  [Stage 58:>                                                                                                               >>>                
           ^
SyntaxError: invalid syntax
>>> >>> # Create an empty list to store DataFrames
  File "<stdin>", line 1
    >>> # Create an empty list to store DataFrames
    ^
SyntaxError: invalid syntax
>>> >>> dfs_per_value = []
  File "<stdin>", line 1
    >>> dfs_per_value = []
    ^
SyntaxError: invalid syntax
>>> >>> 
  D  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> # Loop over unique values and filter DataFrame for each value
  File "<stdin>", line 1
    >>> # Loop over unique values and filter DataFrame for each value
    ^
SyntaxError: invalid syntax
>>> >>> for value in unique_values:
  File "<stdin>", line 1
    >>> for value in unique_values:
    ^
SyntaxError: invalid syntax
>>> ...     # Filter DataFrame for the current value
Ellipsis
>>> ...     filtered_df = df_silver.where(col('Grupo recruitment') == value)
  File "<stdin>", line 1
    ...     filtered_df = df_silver.where(col('Grupo recruitment') == value)
            ^
SyntaxError: invalid syntax
>>> ...     
Ellipsis
>>> ...     # Append filtered DataFrame to the list
Ellipsis
>>> ...     dfs_per_value.append(filtered_df)
  File "<stdin>", line 1
    ...     dfs_per_value.append(filtered_df)
            ^
SyntaxError: invalid syntax
>>> ... 
Ellipsis
>>> >>> # Show the list of DataFrames
  File "<stdin>", line 1
    >>> # Show the list of DataFrames
    ^
SyntaxError: invalid syntax
>>> >>> for idx, df in enumerate(dfs_per_value, start=1):
  File "<stdin>", line 1
    >>> for idx, df in enumerate(dfs_per_value, start=1):
    ^
SyntaxError: invalid syntax
>>> ...     print(f"DataFrame for unique value '{unique_values[idx - 1]}':")
  File "<stdin>", line 1
    ...     print(f"DataFrame for unique value '{unique_values[idx - 1]}':")
            ^
SyntaxError: invalid syntax
>>> ...     df.show()
  File "<stdin>", line 1
    ...     df.show()
            ^
SyntaxError: invalid syntax
>>> ... 
Ellipsis
>>> DataFrame for unique value ' C':
  File "<stdin>", line 1
    DataFrame for unique value ' C':
              ^
SyntaxError: invalid syntax
>>> +---+--------+---------+---------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+--------+---------+---------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                         ^
SyntaxError: invalid syntax
>>> | Id|  Nombre| Apellido|     Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|  Nombre| Apellido|     Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+--------+---------+---------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+--------+---------+---------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                         ^
SyntaxError: invalid syntax
>>> |  3|    Juan| Albornoz|       IT|    2018-06-04|2019-04-30|    4|                C|                            4|             4|             4|      5|            NO|         5|     Alejandro|        Pitorino|                300001|                350000|            330|             325000.5|
  File "<stdin>", line 1
    |  3|    Juan| Albornoz|       IT|    2018-06-04|2019-04-30|    4|                C|                            4|             4|             4|      5|            NO|         5|     Alejandro|        Pitorino|                300001|                350000|            330|             325000.5|
    ^
SyntaxError: invalid syntax
>>> |  5|  Franco|Rodrguez|Marketing|    2017-05-01|2017-11-30|    5|                C|                            6|             5|             4|      1|            SI|         1|       Rolando|           Casas|                350001|                400000|            213|             375000.5|
  File "<stdin>", line 1
    |  5|  Franco|Rodrguez|Marketing|    2017-05-01|2017-11-30|    5|                C|                            6|             5|             4|      1|            SI|         1|       Rolando|           Casas|                350001|                400000|            213|             375000.5|
    ^
SyntaxError: invalid syntax
>>> |  9| Nicolas| Martnez|       IT|    2021-01-04|2021-11-30|    2|                C|                            6|             3|             3|      5|            SI|         5|     Alejandro|        Pitorino|                250001|                300000|            330|             275000.5|
  File "<stdin>", line 1
    |  9| Nicolas| Martnez|       IT|    2021-01-04|2021-11-30|    2|                C|                            6|             3|             3|      5|            SI|         5|     Alejandro|        Pitorino|                250001|                300000|            330|             275000.5|
    ^
SyntaxError: invalid syntax
>>> | 12|    Luis|  Snchez|   Ventas|    2020-07-13|2020-12-31|    5|                C|                            5|             6|             6|      8|            NO|         8|       Ricardo|         Ronaldo|                400001|                500000|            171|             450000.5|
  File "<stdin>", line 1
    | 12|    Luis|  Snchez|   Ventas|    2020-07-13|2020-12-31|    5|                C|                            5|             6|             6|      8|            NO|         8|       Ricardo|         Ronaldo|                400001|                500000|            171|             450000.5|
    ^
SyntaxError: invalid syntax
>>> | 14|    Raul|   Garca|   Ventas|    2019-02-04|2020-03-31|    3|                C|                            6|             3|             3|      8|            SI|         8|       Ricardo|         Ronaldo|                250001|                300000|            421|             275000.5|
  File "<stdin>", line 1
    | 14|    Raul|   Garca|   Ventas|    2019-02-04|2020-03-31|    3|                C|                            6|             3|             3|      8|            SI|         8|       Ricardo|         Ronaldo|                250001|                300000|            421|             275000.5|
    ^
SyntaxError: invalid syntax
>>> | 16|  Vanina|  Bentez|       IT|    2019-08-05|2020-04-30|    5|                C|                            5|             6|             6|      5|            SI|         5|     Alejandro|        Pitorino|                400001|                500000|            269|             450000.5|
  File "<stdin>", line 1
    | 16|  Vanina|  Bentez|       IT|    2019-08-05|2020-04-30|    5|                C|                            5|             6|             6|      5|            SI|         5|     Alejandro|        Pitorino|                400001|                500000|            269|             450000.5|
    ^
SyntaxError: invalid syntax
>>> | 20| Marcelo|   Flores|   Ventas|    2021-09-06|2022-05-31|    2|                C|                            6|             2|             2|      8|            SI|         8|       Ricardo|         Ronaldo|                200001|                250000|            267|             225000.5|
  File "<stdin>", line 1
    | 20| Marcelo|   Flores|   Ventas|    2021-09-06|2022-05-31|    2|                C|                            6|             2|             2|      8|            SI|         8|       Ricardo|         Ronaldo|                200001|                250000|            267|             225000.5|
    ^
SyntaxError: invalid syntax
>>> | 21|Cristian|   Martin|  Compras|    2017-11-06|2020-12-31|    5|                C|                            4|             6|             5|      2|            SI|         2|        Marina|          Pitana|                400001|                500000|           1151|             450000.5|
  File "<stdin>", line 1
    | 21|Cristian|   Martin|  Compras|    2017-11-06|2020-12-31|    5|                C|                            4|             6|             5|      2|            SI|         2|        Marina|          Pitana|                400001|                500000|           1151|             450000.5|
    ^
SyntaxError: invalid syntax
>>> | 23|  Camila|   Prieto|       IT|    2022-01-03|2022-07-01|    6|                C|                            6|             6|             6|      5|            NO|         5|     Alejandro|        Pitorino|                400001|                500000|            179|             450000.5|
  File "<stdin>", line 1
    | 23|  Camila|   Prieto|       IT|    2022-01-03|2022-07-01|    6|                C|                            6|             6|             6|      5|            NO|         5|     Alejandro|        Pitorino|                400001|                500000|            179|             450000.5|
    ^
SyntaxError: invalid syntax
>>> | 29|   Dante|  Martini|       IT|    2021-03-01|2021-12-31|    4|                C|                            6|             3|             3|      5|            NO|         5|     Alejandro|        Pitorino|                250001|                300000|            305|             275000.5|
------+--------------+----------------+------------  File "<stdin>", line 1
    | 29|   Dante|  Martini|       IT|    2021-03-01|2021-12-31|    4|                C|                            6|             3|             3|      5|            NO|         5|     Alejandro|        Pitorino|                250001|                300000|            305|             275000.5|
    ^
SyntaxError: invalid syntax
>>> | 30|   Diego|    Buzos|Auditoria|    2021-09-06|2022-06-30|    1|                C|                            3|             1|             1|     10|            SI|        10|        Daniel|         Quiroga|                150000|                200000|            297|             175000.0|
  File "<stdin>", line 1
    | 30|   Diego|    Buzos|Auditoria|    2021-09-06|2022-06-30|    1|                C|                            3|             1|             1|     10|            SI|        10|        Daniel|         Quiroga|                150000|                200000|            297|             175000.0|
    ^
SyntaxError: invalid syntax
>>> +---+--------+---------+---------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+--------+---------+---------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                         ^
SyntaxError: invalid syntax
>>> 
>>> DataFrame for unique value ' B':
  File "<stdin>", line 1
    DataFrame for unique value ' B':
              ^
SyntaxError: invalid syntax
>>> +---+--------+--------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+--------+--------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                         ^
SyntaxError: invalid syntax
>>> | Id|  Nombre|Apellido|      Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|  Nombre|Apellido|      Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+--------+--------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+--------+--------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                         ^
SyntaxError: invalid syntax
>>> |  1|  Romina|   Brito| Marketing|    2018-03-05|2018-12-31|    3|                B|                            3|             3|             3|      1|            SI|         1|       Rolando|           Casas|                250001|                300000|            301|             275000.5|
  File "<stdin>", line 1
    |  1|  Romina|   Brito| Marketing|    2018-03-05|2018-12-31|    3|                B|                            3|             3|             3|      1|            SI|         1|       Rolando|           Casas|                250001|                300000|            301|             275000.5|
    ^
SyntaxError: invalid syntax
>>> |  2|   Pedro|   Lujan|   Compras|    2017-03-06|2021-12-31|    3|                B|                            3|             2|             2|      2|            SI|         2|        Marina|          Pitana|                200001|                250000|           1761|             225000.5|
  File "<stdin>", line 1
    |  2|   Pedro|   Lujan|   Compras|    2017-03-06|2021-12-31|    3|                B|                            3|             2|             2|      2|            SI|         2|        Marina|          Pitana|                200001|                250000|           1761|             225000.5|
    ^
SyntaxError: invalid syntax
>>> |  6|Catalina|   Gmez|Produccin|    2019-04-01|2022-03-31|    2|                B|                            4|             2|             2|      4|            NO|         4|        Miriam|          Pisani|                200001|                250000|           1095|             225000.5|
  File "<stdin>", line 1
    |  6|Catalina|   Gmez|Produccin|    2019-04-01|2022-03-31|    2|                B|                            4|             2|             2|      4|            NO|         4|        Miriam|          Pisani|                200001|                250000|           1095|             225000.5|
    ^
SyntaxError: invalid syntax
>>> | 11| Roberto|   Prez| Marketing|    2019-07-01|2022-04-30|    5|                B|                            5|             5|             5|      9|            SI|         9|        Vanina|        Quintana|                350001|                400000|           1034|             375000.5|
  File "<stdin>", line 1
    | 11| Roberto|   Prez| Marketing|    2019-07-01|2022-04-30|    5|                B|                            5|             5|             5|      9|            SI|         9|        Vanina|        Quintana|                350001|                400000|           1034|             375000.5|
    ^
SyntaxError: invalid syntax
>>> | 18|   Pedro|  Torres| Marketing|    2017-04-03|2019-12-31|    3|                B|                            4|             3|             3|      9|            SI|         9|        Vanina|        Quintana|                250001|                300000|           1002|             275000.5|
  File "<stdin>", line 1
    | 18|   Pedro|  Torres| Marketing|    2017-04-03|2019-12-31|    3|                B|                            4|             3|             3|      9|            SI|         9|        Vanina|        Quintana|                250001|                300000|           1002|             275000.5|
    ^
SyntaxError: invalid syntax
>>> | 22|  Matias| Bosques|    Ventas|    2018-12-03|2021-06-30|    4|                B|                            3|             4|             4|      8|            SI|         8|       Ricardo|         Ronaldo|                300001|                350000|            940|             325000.5|
  File "<stdin>", line 1
    | 22|  Matias| Bosques|    Ventas|    2018-12-03|2021-06-30|    4|                B|                            3|             4|             4|      8|            SI|         8|       Ricardo|         Ronaldo|                300001|                350000|            940|             325000.5|
    ^
SyntaxError: invalid syntax
>>> | 25|Carolina|Petersen|    Ventas|    2021-07-05|2022-02-28|    7|                B|                            4|             6|             6|      8|            SI|         8|       Ricardo|         Ronaldo|                400001|                500000|            238|             450000.5|
  File "<stdin>", line 1
    | 25|Carolina|Petersen|    Ventas|    2021-07-05|2022-02-28|    7|                B|                            4|             6|             6|      8|            SI|         8|       Ricardo|         Ronaldo|                400001|                500000|            238|             450000.5|
    ^
SyntaxError: invalid syntax
>>> | 26|  Fabian|  Quiroz|Produccin|    2018-05-07|2021-09-30|    3|                B|                            3|             2|             3|      6|            SI|         6|         Sonia|        Kamlasky|                200001|                250000|           1242|             225000.5|
  File "<stdin>", line 1
    | 26|  Fabian|  Quiroz|Produccin|    2018-05-07|2021-09-30|    3|                B|                            3|             2|             3|      6|            SI|         6|         Sonia|        Kamlasky|                200001|                250000|           1242|             225000.5|
    ^
SyntaxError: invalid syntax
>>> +---+--------+--------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+--------+--------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                         ^
SyntaxError: invalid syntax
>>> 
>>> DataFrame for unique value ' A':
  File "<stdin>", line 1
    DataFrame for unique value ' A':
              ^
SyntaxError: invalid syntax
>>> +---+---------+---------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+---------+---------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                           ^
SyntaxError: invalid syntax
>>> | Id|   Nombre| Apellido|      Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|   Nombre| Apellido|      Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+---------+---------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+---------+---------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                           ^
SyntaxError: invalid syntax
>>> |  4|Sebastian| Gonzlez|   Legales|    2018-05-07|2021-05-30|    2|                A|                            4|             2|             2|      3|            SI|         3|          Jos|        Feligres|                200001|                250000|           1119|             225000.5|
  File "<stdin>", line 1
    |  4|Sebastian| Gonzlez|   Legales|    2018-05-07|2021-05-30|    2|                A|                            4|             2|             2|      3|            SI|         3|          Jos|        Feligres|                200001|                250000|           1119|             225000.5|
    ^
SyntaxError: invalid syntax
>>> |  7| Anabella|Fernndez|    Ventas|    2020-07-06|2021-03-31|    4|                A|                            3|             4|             4|      8|            NO|         8|       Ricardo|         Ronaldo|                300001|                350000|            268|             325000.5|
  File "<stdin>", line 1
    |  7| Anabella|Fernndez|    Ventas|    2020-07-06|2021-03-31|    4|                A|                            3|             4|             4|      8|            NO|         8|       Ricardo|         Ronaldo|                300001|                350000|            268|             325000.5|
    ^
SyntaxError: invalid syntax
>>> |  8|Francesca|    Lpez|   Compras|    2017-01-02|2021-06-30|    3|                A|                            4|             3|             3|      2|            SI|         2|        Marina|          Pitana|                250001|                300000|           1640|             275000.5|
  File "<stdin>", line 1
    |  8|Francesca|    Lpez|   Compras|    2017-01-02|2021-06-30|    3|                A|                            4|             3|             3|      2|            SI|         2|        Marina|          Pitana|                250001|                300000|           1640|             275000.5|
    ^
SyntaxError: invalid syntax
>>> | 10|      Ana|     Diaz|        IT|    2017-03-06|2020-11-30|    4|                A|                            3|             3|             3|      7|            NO|         7|        Martn|          Viglia|                250001|                300000|           1365|             275000.5|
  File "<stdin>", line 1
    | 10|      Ana|     Diaz|        IT|    2017-03-06|2020-11-30|    4|                A|                            3|             3|             3|      7|            NO|         7|        Martn|          Viglia|                250001|                300000|           1365|             275000.5|
    ^
SyntaxError: invalid syntax
>>> | 13|Alejandro|   Romero|        IT|    2020-06-01|2022-02-28|    3|                A|                            3|             4|             3|      7|            SI|         7|        Martn|          Viglia|                300001|                350000|            637|             325000.5|
  File "<stdin>", line 1
    | 13|Alejandro|   Romero|        IT|    2020-06-01|2022-02-28|    3|                A|                            3|             4|             3|      7|            SI|         7|        Martn|          Viglia|                300001|                350000|            637|             325000.5|
    ^
SyntaxError: invalid syntax
>>> | 15|   Analia|     Sosa|   Compras|    2018-10-01|2021-11-30|    4|                A|                            4|             4|             4|      2|            NO|         2|        Marina|          Pitana|                300001|                350000|           1156|             325000.5|
  File "<stdin>", line 1
    | 15|   Analia|     Sosa|   Compras|    2018-10-01|2021-11-30|    4|                A|                            4|             4|             4|      2|            NO|         2|        Marina|          Pitana|                300001|                350000|           1156|             325000.5|
    ^
SyntaxError: invalid syntax
>>> | 17|Guillermo|  Ramrez|        IT|    2020-01-06|2022-05-31|    2|                A|                            3|             2|             2|      7|            NO|         7|        Martn|          Viglia|                200001|                250000|            876|             225000.5|
  File "<stdin>", line 1
    | 17|Guillermo|  Ramrez|        IT|    2020-01-06|2022-05-31|    2|                A|                            3|             2|             2|      7|            NO|         7|        Martn|          Viglia|                200001|                250000|            876|             225000.5|
    ^
SyntaxError: invalid syntax
>>> | 19|    Rocio|     Ruiz| Auditoria|    2018-02-05|2021-01-30|    4|                A|                            4|             4|             5|     10|            NO|        10|        Daniel|         Quiroga|                300001|                350000|           1090|             325000.5|
  File "<stdin>", line 1
    | 19|    Rocio|     Ruiz| Auditoria|    2018-02-05|2021-01-30|    4|                A|                            4|             4|             5|     10|            NO|        10|        Daniel|         Quiroga|                300001|                350000|           1090|             325000.5|
    ^
SyntaxError: invalid syntax
>>> | 24|  Micaela|    Pauls|Produccin|    2019-01-07|2021-12-31|    6|                A|                            5|             6|             6|      4|            SI|         4|        Miriam|          Pisani|                400001|                500000|           1089|             450000.5|
  File "<stdin>", line 1
    | 24|  Micaela|    Pauls|Produccin|    2019-01-07|2021-12-31|    6|                A|                            5|             6|             6|      4|            SI|         4|        Miriam|          Pisani|                400001|                500000|           1089|             450000.5|
    ^
SyntaxError: invalid syntax
>>> | 27|  Rodrigo|  Molinas|   Compras|    2019-06-03|2022-04-30|    2|                A|                            4|             2|             2|      2|            SI|         2|        Marina|          Pitana|                200001|                250000|           1062|             225000.5|
  File "<stdin>", line 1
    | 27|  Rodrigo|  Molinas|   Compras|    2019-06-03|2022-04-30|    2|                A|                            4|             2|             2|      2|            SI|         2|        Marina|          Pitana|                200001|                250000|           1062|             225000.5|
    ^
SyntaxError: invalid syntax
>>> | 28|  Martina| Oliviera|Produccin|    2020-01-06|2022-06-30|    7|                A|                            4|             6|             6|      6|            SI|         6|         Sonia|        Kamlasky|                400001|                500000|            906|             450000.5|
  File "<stdin>", line 1
    | 28|  Martina| Oliviera|Produccin|    2020-01-06|2022-06-30|    7|                A|                            4|             6|             6|      6|            SI|         6|         Sonia|        Kamlasky|                400001|                500000|            906|             450000.5|
    ^
SyntaxError: invalid syntax
>>> +---+---------+---------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+---------+---------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                           ^
SyntaxError: invalid syntax
>>> 
>>> >>> from pyspark.sql.functions import col
  File "<stdin>", line 1
    >>> from pyspark.sql.functions import col
    ^
SyntaxError: invalid syntax
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> # Filter DataFrame for each unique value
  File "<stdin>", line 1
    >>> # Filter DataFrame for each unique value
    ^
SyntaxError: invalid syntax
>>> >>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
  File "<stdin>", line 1
    >>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
    ^
SyntaxError: invalid syntax
>>> >>> grupoB = df_silver.where(col('Grupo recruitment') == 'B')
  File "<stdin>", line 1
    >>> grupoB = df_silver.where(col('Grupo recruitment') == 'B')
    ^
SyntaxError: invalid syntax
>>> >>> grupoC = df_silver.where(col('Grupo recruitment') == 'C')
  File "<stdin>", line 1
    >>> grupoC = df_silver.where(col('Grupo recruitment') == 'C')
    ^
SyntaxError: invalid syntax
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> # Show the DataFrames
  File "<stdin>", line 1
    >>> # Show the DataFrames
    ^
SyntaxError: invalid syntax
>>> >>> print("DataFrame for unique value 'A':")
  File "<stdin>", line 1
    >>> print("DataFrame for unique value 'A':")
    ^
SyntaxError: invalid syntax
>>> DataFrame for unique value 'A':
  File "<stdin>", line 1
    DataFrame for unique value 'A':
              ^
SyntaxError: invalid syntax
>>> >>> grupoA.show()
  File "<stdin>", line 1
    >>> grupoA.show()
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> print("DataFrame for unique value 'B':")
  File "<stdin>", line 1
    >>> print("DataFrame for unique value 'B':")
    ^
SyntaxError: invalid syntax
>>> DataFrame for unique value 'B':
  File "<stdin>", line 1
    DataFrame for unique value 'B':
              ^
SyntaxError: invalid syntax
>>> >>> grupoB.show()
  File "<stdin>", line 1
    >>> grupoB.show()
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
s>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> print("DataFrame for unique value 'C':")
  File "<stdin>", line 1
    >>> print("DataFrame for unique value 'C':")
    ^
SyntaxError: invalid syntax
>>> DataFrame for unique value 'C':
  File "<stdin>", line 1
    DataFrame for unique value 'C':
              ^
SyntaxError: invalid syntax
>>> >>> grupoC.show()
  File "<stdin>", line 1
    >>> grupoC.show()
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
      A|                            4|            File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> grupoA = df_silver.where(col('Grupo recruitment') == A)
  File "<stdin>", line 1
    >>> grupoA = df_silver.where(col('Grupo recruitment') == A)
    ^
SyntaxError: invalid syntax
>>> Traceback (most recent call last):
  File "<stdin>", line 1
    Traceback (most recent call last):
                    ^
SyntaxError: invalid syntax
>>>   File "<stdin>", line 1, in <module>
  File "<stdin>", line 1
    File "<stdin>", line 1, in <module>
    ^
IndentationError: unexpected indent
>>> NameError: name 'A' is not defined
  File "<stdin>", line 1
    NameError: name 'A' is not defined
                    ^
SyntaxError: invalid syntax
>>> >>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
  File "<stdin>", line 1
    >>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
    ^
SyntaxError: invalid syntax
>>> >>> grupoA.show(3)
  File "<stdin>", line 1
    >>> grupoA.show(3)
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> distinct_values_A = df_silver.where(col('Grupo recruitment') == 'A').select('Grupo recruitment').distinct()
  File "<stdin>", line 1
    >>> distinct_values_A = df_silver.where(col('Grupo recruitment') == 'A').select('Grupo recruitment').distinct()
    ^
SyntaxError: invalid syntax
>>> >>> distinct_values_A.show(5)
  File "<stdin>", line 1
    >>> distinct_values_A.show(5)
    ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> |Grupo recruitment|
  File "<stdin>", line 1
    |Grupo recruitment|
    ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> 
>>> >>> df_silver.show(3)
  File "<stdin>", line 1
    >>> df_silver.show(3)
    ^
SyntaxError: invalid syntax
>>> +---+---------+---------+-------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+---------+---------+-------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                        ^
SyntaxError: invalid syntax
>>> | Id|   Nombre| Apellido|   Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|   Nombre| Apellido|   Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+---------+---------+-------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+---------+---------+-------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                        ^
SyntaxError: invalid syntax
>>> |  4|Sebastian| Gonzlez|Legales|    2018-05-07|2021-05-30|    2|                A|                            4|             2|             2|      3|            SI|         3|          Jos|        Feligres|                200001|                250000|           1119|             225000.5|
  File "<stdin>", line 1
    |  4|Sebastian| Gonzlez|Legales|    2018-05-07|2021-05-30|    2|                A|                            4|             2|             2|      3|            SI|         3|          Jos|        Feligres|                200001|                250000|           1119|             225000.5|
    ^
SyntaxError: invalid syntax
>>> |  7| Anabella|Fernndez| Ventas|    2020-07-06|2021-03-31|    4|                A|                            3|             4|             4|      8|            NO|         8|       Ricardo|         Ronaldo|                300001|                350000|            268|             325000.5|
  File "<stdin>", line 1
    |  7| Anabella|Fernndez| Ventas|    2020-07-06|2021-03-31|    4|                A|                            3|             4|             4|      8|            NO|         8|       Ricardo|         Ronaldo|                300001|                350000|            268|             325000.5|
    ^
SyntaxError: invalid syntax
>>> |  8|Francesca|    Lpez|Compras|    2017-01-02|2021-06-30|    3|                A|                            4|             3|             3|      2|            SI|         2|        Marina|          Pitana|                250001|                300000|           1640|             275000.5|
  File "<stdin>", line 1
    |  8|Francesca|    Lpez|Compras|    2017-01-02|2021-06-30|    3|                A|                            4|             3|             3|      2|            SI|         2|        Marina|          Pitana|                250001|                300000|           1640|             275000.5|
    ^
SyntaxError: invalid syntax
>>> +---+---------+---------+-------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+---------+---------+-------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                        ^
SyntaxError: invalid syntax
>>> only showing top 3 rows
  File "<stdin>", line 1
    only showing top 3 rows
         ^
SyntaxError: invalid syntax
>>> 
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> It seems like you're trying to filter your DataFrame by unique values in the 'Grupo recruitment' column in Apache Spark. Let's review the steps you've taken:
do_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+------+--------+----+--------------+---------+-----+-----  File "<stdin>", line 1
    It seems like you're trying to filter your DataFrame by unique values in the 'Grupo recruitment' column in Apache Spark. Let's review the steps you've taken:
       ^
SyntaxError: invalid syntax
>>> 
>>> You used the where method to filter the DataFrame for each unique value in the 'Grupo recruitment' column. You also tried using the filter method with the isin function, but it didn't return any rows for the specified condition.
  File "<stdin>", line 1
    You used the where method to filter the DataFrame for each unique value in the 'Grupo recruitment' column. You also tried using the filter method with the isin function, but it didn't return any rows for the specified condition.
        ^
SyntaxError: invalid syntax
>>> Then, you attempted to extract unique values in the 'Grupo recruitment' column using Spark SQL functions, which returned an empty DataFrame for value 'A'. This might indicate that there are no rows with 'A' in the 'Grupo recruitment' column.
  File "<stdin>", line 1
    Then, you attempted to extract unique values in the 'Grupo recruitment' column using Spark SQL functions, which returned an empty DataFrame for value 'A'. This might indicate that there are no rows with 'A' in the 'Grupo recruitment' column.
              ^
SyntaxError: invalid syntax
>>> You also attempted to filter the DataFrame by explicitly specifying the value 'A' without quotes, which resulted in a NameError because 'A' wasn't defined as a variable.
  File "<stdin>", line 1
    You also attempted to filter the DataFrame by explicitly specifying the value 'A' without quotes, which resulted in a NameError because 'A' wasn't defined as a variable.
        ^
SyntaxError: invalid syntax
>>> Finally, you displayed the entire DataFrame to review its contents.
  File "<stdin>", line 1
    Finally, you displayed the entire DataFrame to review its contents.
                 ^
SyntaxError: invalid syntax
>>> From the provided code and outputs, it appears that there might be no rows with the value 'A' in the 'Grupo recruitment' column. You may want to verify the data and ensure that the values you're filtering for exist in the DataFrame.
  File "<stdin>", line 1
    From the provided code and outputs, it appears that there might be no rows with the value 'A' in the 'Grupo recruitment' column. You may want to verify the data and ensure that the values you're filtering for exist in the DataFrame.
         ^
SyntaxError: invalid syntax
>>> 
>>> only showing top 3 rows
  File "<stdin>", line 1
    only showing top 3 rows
         ^
SyntaxError: invalid syntax
>>> 
>>> >>> df_silver.select('Grupo recruitment').show(3)
  File "<stdin>", line 1
    >>> df_silver.select('Grupo recruitment').show(3)
    ^
SyntaxError: invalid syntax
>>> +-----------------+                                                             
  File "<stdin>", line 1
    +-----------------+                                                             
                                                                                   ^
SyntaxError: invalid syntax
>>> |Grupo recruitment|
  File "<stdin>", line 1
    |Grupo recruitment|
    ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> |                A|
  File "<stdin>", line 1
    |                A|
    ^
SyntaxError: invalid syntax
>>> |                A|
  File "<stdin>", line 1
    |                A|
    ^
SyntaxError: invalid syntax
>>> |                A|
  File "<stdin>", line 1
    |                A|
    ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> only showing top 3 rows
  File "<stdin>", line 1
    only showing top 3 rows
         ^
SyntaxError: invalid syntax
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> It seems like there are indeed rows with the value 'A' in the 'Grupo recruitment' column, as shown by the output of df_silver.select('Grupo recruitment').show(3).
  File "<stdin>", line 1
    It seems like there are indeed rows with the value 'A' in the 'Grupo recruitment' column, as shown by the output of df_silver.select('Grupo recruitment').show(3).
       ^
SyntaxError: invalid syntax
>>> 
>>> Given that there are rows with 'A' in the 'Grupo recruitment' column, the empty result when filtering for 'A' might indicate a data inconsistency or an issue with the filtering condition. Let's double-check the filtering process to ensure it's correctly implemented. Could you please provide the specific code snippet where you're filtering for the 'A' value so that we can investigate further?
----+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> grupoA = df_silver.where(col('Grupo recruitment') =  File "<stdin>", line 1
    Given that there are rows with 'A' in the 'Grupo recruitment' column, the empty result when filtering for 'A' might indicate a data inconsistency or an issue with the filtering condition. Let's double-check the filtering process to ensure it's correctly implemented. Could you please provide the specific code snippet where you're filtering for the 'A' value so that we can investigate further?
          ^
SyntaxError: invalid syntax
>>> 
>>> >>> from pyspark.sql.functions import col
  File "<stdin>", line 1
    >>> from pyspark.sql.functions import col
    ^
SyntaxError: invalid syntax
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> # Filter DataFrame for each unique value
  File "<stdin>", line 1
    >>> # Filter DataFrame for each unique value
    ^
SyntaxError: invalid syntax
>>> >>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
  File "<stdin>", line 1
    >>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
    ^
SyntaxError: invalid syntax
>>> >>> grupoB = df_silver.where(col('Grupo recruitment') == 'B')
  File "<stdin>", line 1
    >>> grupoB = df_silver.where(col('Grupo recruitment') == 'B')
    ^
SyntaxError: invalid syntax
>>> >>> grupoC = df_silver.where(col('Grupo recruitment') == 'C')
  File "<stdin>", line 1
    >>> grupoC = df_silver.where(col('Grupo recruitment') == 'C')
    ^
SyntaxError: invalid syntax
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> # Show the DataFrames
  File "<stdin>", line 1
    >>> # Show the DataFrames
    ^
SyntaxError: invalid syntax
>>> >>> print("DataFrame for unique value 'A':")
  File "<stdin>", line 1
    >>> print("DataFrame for unique value 'A':")
    ^
SyntaxError: invalid syntax
>>> DataFrame for unique value 'A':
  File "<stdin>", line 1
    DataFrame for unique value 'A':
              ^
SyntaxError: invalid syntax
>>> >>> grupoA.show()
  File "<stdin>", line 1
    >>> grupoA.show()
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
o>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> print("DataFrame for unique value 'B':")
  File "<stdin>", line 1
    >>> print("DataFrame for unique value 'B':")
    ^
SyntaxError: invalid syntax
>>> DataFrame for unique value 'B':
  File "<stdin>", line 1
    DataFrame for unique value 'B':
              ^
SyntaxError: invalid syntax
>>> >>> grupoB.show()
  File "<stdin>", line 1
    >>> grupoB.show()
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> print("DataFrame for unique value 'C':")
  File "<stdin>", line 1
    >>> print("DataFrame for unique value 'C':")
    ^
SyntaxError: invalid syntax
>>> DataFrame for unique value 'C':
  File "<stdin>", line 1
    DataFrame for unique value 'C':
              ^
SyntaxError: invalid syntax
>>> >>> grupoC.show()
  File "<stdin>", line 1
    >>> grupoC.show()
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> grupoA = df_silver.where(col('Grupo recruitment') == A)
  File "<stdin>", line 1
    >>> grupoA = df_silver.where(col('Grupo recruitment') == A)
    ^
SyntaxError: invalid syntax
>>> Traceback (most recent call last):
  File "<stdin>", line 1
    Traceback (most recent call last):
                    ^
SyntaxError: invalid syntax
>>>   File "<stdin>", line 1, in <module>
  File "<stdin>", line 1
    File "<stdin>", line 1, in <module>
    ^
IndentationError: unexpected indent
>>> NameError: name 'A' is not defined
  File "<stdin>", line 1
    NameError: name 'A' is not defined
                    ^
SyntaxError: invalid syntax
>>> >>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
  File "<stdin>", line 1
    >>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
    ^
SyntaxError: invalid syntax
>>> >>> grupoA.show(3)
po  File "<stdin>", line 1
    >>> grupoA.show(3)
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
d.
This achieves the same result as filtering using the DataFrame API, but using SQL syntax instead.

>>> df_silver.select('Grupo recruitment').show(3)
+-----------------+                                                             
|Grupo recruitment|
+-----------------+
|                A|
|                A|
|                A|
+-----------------+
only showing top 3 rows

>>> print("Number of rows in DataFrame for unique value 'A':", grupoA.count())
Number of rows in DataFrame for unique value 'A': 0                             
>>> df_silver.createOrReplaceTemp>>> It appears that there are no data rows in the DataFrames grupoA, grupoB, and grupoC. This suggests that there might be no records in the original DataFrame df_silver that match the conditions for each group ('A', 'B', and 'C').
  File "<stdin>", line 1
    It appears that there are no data rows in the DataFrames grupoA, grupoB, and grupoC. This suggests that there might be no records in the original DataFrame df_silver that match the conditions for each group ('A', 'B', and 'C').
       ^
SyntaxError: invalid syntax
>>> 
->>> To confirm this, you can try to count the number of rows in each DataFrame. For example:
  File "<stdin>", line 1
    To confirm this, you can try to count the number of rows in each DataFrame. For example:
       ^
SyntaxError: invalid syntax
>>> 
->>> python
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'python' is not defined
>>> Copy code
  File "<stdin>", line 1
    Copy code
         ^
SyntaxError: invalid syntax
>>> print("Number of rows in DataFrame for unique value 'A':", grupoA.count())
Number of rows in DataFrame for unique value 'A': 0
>>> print("Number of rows in DataFrame for unique value 'B':", grupoB.count())
Number of rows in DataFrame for unique value 'B': 0
>>> print("Number of rows in DataFrame for unique value 'C':", grupoC.count())
Number of rows in DataFrame for unique value 'C': 0
>>> This will give you the count of rows for each DataFrame, helping to verify if there are indeed no records matching the conditions. If there are records, it might be necessary to review the filtering conditions or the data itself to understand why they are not being captured.
  File "<stdin>", line 1
    This will give you the count of rows for each DataFrame, helping to verify if there are indeed no records matching the conditions. If there are records, it might be necessary to review the filtering conditions or the data itself to understand why they are not being captured.
         ^
SyntaxError: invalid syntax
>>> 
>>> >>> print("Number of rows in DataFrame for unique value 'A':", grupoA.count())
  File "<stdin>", line 1
    >>> print("Number of rows in DataFrame for unique value 'A':", grupoA.count())
    ^
SyntaxError: invalid syntax
>>> Number of rows in DataFrame for unique value 'A': 0      
  File "<stdin>", line 1
    Number of rows in DataFrame for unique value 'A': 0      
           ^
SyntaxError: invalid syntax
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> As suspected, the DataFrame for the unique value 'A' is empty, which means there are no records in df_silver where the "Grupo recruitment" column value is 'A'.
  File "<stdin>", line 1
    As suspected, the DataFrame for the unique value 'A' is empty, which means there are no records in df_silver where the "Grupo recruitment" column value is 'A'.
       ^
SyntaxError: invalid syntax
>>> 
>>> This result suggests that there might be no employees in group 'A' in your dataset. You might want to review your data or the criteria used for filtering to ensure it matches your expectations. If you expected to have employees in group 'A', you might need to double-check the data or the condition used for filtering.
  File "<stdin>", line 1
    This result suggests that there might be no employees in group 'A' in your dataset. You might want to review your data or the criteria used for filtering to ensure it matches your expectations. If you expected to have employees in group 'A', you might need to double-check the data or the condition used for filtering.
         ^
SyntaxError: invalid syntax
>>> 
>>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
>>> this with python in pyspark
  File "<stdin>", line 1
    this with python in pyspark
         ^
SyntaxError: invalid syntax
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> Yes, the line grupoA = df_silver.where(col('Grupo recruitment') == 'A') is indeed Python code written in PySpark.
  File "<stdin>", line 1
    Yes, the line grupoA = df_silver.where(col('Grupo recruitment') == 'A') is indeed Python code written in PySpark.
             ^
SyntaxError: invalid syntax
>>> 
>>> Here's a breakdown of what it does:
  File "<stdin>", line 1
    Here's a breakdown of what it does:
                                      ^
SyntaxError: EOL while scanning string literal
>>> 
>>> df_silver: This is assumed to be a DataFrame in PySpark. The name suggests it contains data related to silver, but the actual content would depend on your specific application.
  File "<stdin>", line 1
    df_silver: This is assumed to be a DataFrame in PySpark. The name suggests it contains data related to silver, but the actual content would depend on your specific application.
                               ^
SyntaxError: invalid syntax
>>> .where(): This method is used to filter rows based on a condition. It takes a predicate (a condition) as an argument and returns a new DataFrame containing only the rows for which the condition is true.
  File "<stdin>", line 1
    .where(): This method is used to filter rows based on a condition. It takes a predicate (a condition) as an argument and returns a new DataFrame containing only the rows for which the condition is true.
    ^
SyntaxError: invalid syntax
>>> col('Grupo recruitment'): This refers to the "Grupo recruitment" column in the DataFrame. The col() function is used to create a Column object representing a column in the DataFrame.
  File "<stdin>", line 1
    col('Grupo recruitment'): This refers to the "Grupo recruitment" column in the DataFrame. The col() function is used to create a Column object representing a column in the DataFrame.
                                   ^
SyntaxError: invalid syntax
>>> == 'A': This is the condition being applied. It checks if the value in the "Grupo recruitment" column is equal to 'A'.
  File "<stdin>", line 1
    == 'A': This is the condition being applied. It checks if the value in the "Grupo recruitment" column is equal to 'A'.
    ^
SyntaxError: invalid syntax
>>> So, overall, this line of code filters the DataFrame df_silver to only include rows where the value in the "Grupo recruitment" column is 'A', and assigns the result to the variable grupoA.
  File "<stdin>", line 1
    So, overall, this line of code filters the DataFrame df_silver to only include rows where the value in the "Grupo recruitment" column is 'A', and assigns the result to the variable grupoA.
                      ^
SyntaxError: invalid syntax
>>> 
>>> do it with a view using sql
  File "<stdin>", line 1
    do it with a view using sql
       ^
SyntaxError: invalid syntax
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> Sure, you can achieve the same filtering using SQL syntax in PySpark by creating a temporary view and then executing SQL queries on that view. Here's how you can do it:
  File "<stdin>", line 1
    Sure, you can achieve the same filtering using SQL syntax in PySpark by creating a temporary view and then executing SQL queries on that view. Here's how you can do it:
              ^
SyntaxError: invalid syntax
>>> 
>>> python
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'python' is not defined
>>> Copy code
  File "<stdin>", line 1
    Copy code
         ^
SyntaxError: invalid syntax
>>> # Register DataFrame as a temporary view
>>> df_silver.createOrReplaceTempView("silver_view")
>>> 
>>> # Execute SQL query to filter rows where 'Grupo recruitment' is 'A'
>>> grupoA = spark.sql("SELECT * FROM silver_view WHERE `Grupo recruitment` = 'A'")
>>> 
>>> # Show the resulting DataFrame
>>> grupoA.show()
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> This code performs the following steps:
  File "<stdin>", line 1
    This code performs the following steps:
         ^
SyntaxError: invalid syntax
>>> 
>>> It registers the DataFrame df_silver as a temporary view named "silver_view" using the createOrReplaceTempView() method. This allows you to refer to the DataFrame using SQL syntax.
  File "<stdin>", line 1
    It registers the DataFrame df_silver as a temporary view named "silver_view" using the createOrReplaceTempView() method. This allows you to refer to the DataFrame using SQL syntax.
       ^
SyntaxError: invalid syntax
>>> It executes an SQL query using spark.sql(), which filters the rows from the "silver_view" where the value of the "Grupo recruitment" column is 'A'.
  File "<stdin>", line 1
    It executes an SQL query using spark.sql(), which filters the rows from the "silver_view" where the value of the "Grupo recruitment" column is 'A'.
       ^
SyntaxError: invalid syntax
>>> Finally, it shows the resulting DataFrame using the show() method.
  File "<stdin>", line 1
    Finally, it shows the resulting DataFrame using the show() method.
                ^
SyntaxError: invalid syntax
>>> This achieves the same result as filtering using the DataFrame API, but using SQL syntax instead.
  File "<stdin>", line 1
    This achieves the same result as filtering using the DataFrame API, but using SQL syntax instead.
         ^
SyntaxError: invalid syntax
>>> 
>>> >>> df_silver.select('Grupo recruitment').show(3)
  File "<stdin>", line 1
    >>> df_silver.select('Grupo recruitment').show(3)
    ^
SyntaxError: invalid syntax
>>> +-----------------+                                                             
  File "<stdin>", line 1
    +-----------------+                                                             
                                                                                   ^
SyntaxError: invalid syntax
>>> |Grupo recruitment|
  File "<stdin>", line 1
    |Grupo recruitment|
    ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> |                A|
  File "<stdin>", line 1
    |                A|
    ^
SyntaxError: invalid syntax
>>> |                A|
  File "<stdin>", line 1
    |                A|
    ^
SyntaxError: invalid syntax
>>> |                A|
  File "<stdin>", line 1
    |                A|
    ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> only showing top 3 rows
  File "<stdin>", line 1
    only showing top 3 rows
         ^
SyntaxError: invalid syntax
>>> 
>>> >>> print("Number of rows in DataFrame for unique value 'A':", grupoA.count())
  File "<stdin>", line 1
    >>> print("Number of rows in DataFrame for unique value 'A':", grupoA.count())
    ^
SyntaxError: invalid syntax
>>> Number of rows in DataFrame for unique value 'A': 0                             
  File "<stdin>", line 1
    Number of rows in DataFrame for unique value 'A': 0                             
           ^
SyntaxError: invalid syntax
>>> >>> df_silver.createOrReplaceTempView("silver_view")
  File "<stdin>", line 1
    >>> df_silver.createOrReplaceTempView("silver_view")
    ^
SyntaxError: invalid syntax
>>> >>> grupoA = spark.sql("SELECT * FROM silver_view WHERE `Grupo recruitment` = 'A'")
  File "<stdin>", line 1
    >>> grupoA = spark.sql("SELECT * FROM silver_view WHERE `Grupo recruitment` = 'A'")
    ^
SyntaxError: invalid syntax
>>> >>> grupoA.show()
  File "<stdin>", line 1
    >>> grupoA.show()
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> df_silver.select('Grupo recruitment').show(3)
  File "<stdin>", line 1
    >>> df_silver.select('Grupo recruitment').show(3)
    ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> |Grupo recruitment|
  File "<stdin>", line 1
    |Grupo recruitment|
    ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> |                A|
  File "<stdin>", line 1
    |                A|
    ^
SyntaxError: invalid syntax
>>> |                A|
  File "<stdin>", line 1
    |                A|
    ^
SyntaxError: invalid syntax
>>> |                A|
  File "<stdin>", line 1
    |                A|
    ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> only showing top 3 rows
  File "<stdin>", line 1
    only showing top 3 rows
         ^
SyntaxError: invalid syntax
>>> 
>>> >>> df_silver.printSchema()
  File "<stdin>", line 1
    >>> df_silver.printSchema()
    ^
SyntaxError: invalid syntax
>>> root
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'root' is not defined
>>>  |-- Id: integer (nullable = true)
  File "<stdin>", line 1
    |-- Id: integer (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Nombre: string (nullable = true)
  File "<stdin>", line 1
    |-- Nombre: string (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Apellido: string (nullable = true)
  File "<stdin>", line 1
    |-- Apellido: string (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Area: string (nullable = true)
  File "<stdin>", line 1
    |-- Area: string (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Fecha comienzo: date (nullable = true)
  File "<stdin>", line 1
    |-- Fecha comienzo: date (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Fecha fin: date (nullable = true)
  File "<stdin>", line 1
    |-- Fecha fin: date (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Nivel: integer (nullable = true)
  File "<stdin>", line 1
    |-- Nivel: integer (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Grupo recruitment: string (nullable = true)
  File "<stdin>", line 1
    |-- Grupo recruitment: string (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Tiempo recruitment en semanas: integer (nullable = true)
  File "<stdin>", line 1
    |-- Tiempo recruitment en semanas: integer (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Rango Salarial: integer (nullable = true)
  File "<stdin>", line 1
    |-- Rango Salarial: integer (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- RS competencia: integer (nullable = true)
  File "<stdin>", line 1
    |-- RS competencia: integer (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Manager: string (nullable = true)
  File "<stdin>", line 1
    |-- Manager: string (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Realizo Cursos: string (nullable = true)
  File "<stdin>", line 1
    |-- Realizo Cursos: string (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Id_Manager: string (nullable = true)
  File "<stdin>", line 1
    |-- Id_Manager: string (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Nombre_Manager: string (nullable = true)
  File "<stdin>", line 1
    |-- Nombre_Manager: string (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Apellido_Manager: string (nullable = true)
  File "<stdin>", line 1
    |-- Apellido_Manager: string (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- sueldo en rublos desde: integer (nullable = true)
  File "<stdin>", line 1
    |-- sueldo en rublos desde: integer (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- sueldo en rublos hasta: integer (nullable = true)
  File "<stdin>", line 1
    |-- sueldo en rublos hasta: integer (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- dias_trabajados: integer (nullable = true)
  File "<stdin>", line 1
    |-- dias_trabajados: integer (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- avg salario en rublos: double (nullable = true)
  File "<stdin>", line 1
    |-- avg salario en rublos: double (nullable = true)
    ^
IndentationError: unexpected indent
>>> 
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> It seems that the DataFrame grupoA is empty, even though there are rows with 'Grupo recruitment' equal to 'A' in the original DataFrame df_silver. Let's debug this together.
  File "<stdin>", line 1
    It seems that the DataFrame grupoA is empty, even though there are rows with 'Grupo recruitment' equal to 'A' in the original DataFrame df_silver. Let's debug this together.
       ^
SyntaxError: invalid syntax
>>> 
>>> First, let's check if there are actually rows in df_silver where 'Grupo recruitment' is 'A' by filtering it directly:
  File "<stdin>", line 1
    First, let's check if there are actually rows in df_silver where 'Grupo recruitment' is 'A' by filtering it directly:
              ^
SyntaxError: invalid syntax
>>> 
>>> python
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'python' is not defined
>>> Copy code
  File "<stdin>", line 1
    Copy code
         ^
SyntaxError: invalid syntax
>>> df_silver.filter(df_silver['Grupo recruitment'] == 'A').show()
remove any leading or trailing whitespace before filtering. We can use the trim() function from PySpark to achieve this.

Here's how we can do it:

python
Copy code
from pyspark.sql.functions import col, trim
>>> filtered_df = df_silver.filter(df_silver['Grupo recruitment'].isin('C'))
>>> filtered_df.show()
+---+------+--------+----+---------+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> If this shows rows, then there might be an issue with how we're filtering when using SQL. Let's ensure there are no typos or issues with column names by listing the columns:
  File "<stdin>", line 1
    If this shows rows, then there might be an issue with how we're filtering when using SQL. Let's ensure there are no typos or issues with column names by listing the columns:
       ^
SyntaxError: invalid syntax
>>> 
>>> python
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'python' is not defined
>>> Copy code
  File "<stdin>", line 1
    Copy code
         ^
SyntaxError: invalid syntax
>>> df_silver.columns
['Id', 'Nombre', 'Apellido', 'Area', 'Fecha comienzo', 'Fecha fin', 'Nivel', 'Grupo recruitment', 'Tiempo recruitment en semanas', 'Rango Salarial', 'RS competencia', 'Manager', 'Realizo Cursos', 'Id_Manager', 'Nombre_Manager', 'Apellido_Manager', 'sueldo en rublos desde', 'sueldo en rublos hasta', 'dias_trabajados', 'avg salario en rublos']
>>> This will display all the column names in df_silver, which you can use to ensure accuracy in your SQL query. If everything looks fine, we can proceed with further troubleshooting. Let me know what you find!
  File "<stdin>", line 1
    This will display all the column names in df_silver, which you can use to ensure accuracy in your SQL query. If everything looks fine, we can proceed with further troubleshooting. Let me know what you find!
         ^
SyntaxError: invalid syntax
>>> 
>>> >>> df_silver.filter(df_silver['Grupo recruitment'] == 'A').show()
  File "<stdin>", line 1
    >>> df_silver.filter(df_silver['Grupo recruitment'] == 'A').show()
    ^
SyntaxError: invalid syntax
>>> 
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> It seems there are indeed rows in df_silver where 'Grupo recruitment' is 'A'. Since we're not getting any results when filtering with SQL, let's double-check the column name and ensure there are no issues there.
  File "<stdin>", line 1
    It seems there are indeed rows in df_silver where 'Grupo recruitment' is 'A'. Since we're not getting any results when filtering with SQL, let's double-check the column name and ensure there are no issues there.
       ^
SyntaxError: invalid syntax
>>> 
>>> You've printed the schema earlier, so we know the column name is correct. Let's verify the syntax for the SQL query and the backticks around column names, just to be sure:
  File "<stdin>", line 1
    You've printed the schema earlier, so we know the column name is correct. Let's verify the syntax for the SQL query and the backticks around column names, just to be sure:
       ^
SyntaxError: invalid syntax
>>> 
>>> python
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'python' is not defined
>>> Copy code
  File "<stdin>", line 1
    Copy code
         ^
SyntaxError: invalid syntax
>>> grupoA = spark.sql("SELECT * FROM silver_view WHERE `Grupo recruitment` = 'A'")
>>> If everything seems correct, we might need to investigate further. Let me know if you find anything!
  File "<stdin>", line 1
    If everything seems correct, we might need to investigate further. Let me know if you find anything!
       ^
SyntaxError: invalid syntax
>>> 
>>> >>> df_silver.columns
  File "<stdin>", line 1
    >>> df_silver.columns
    ^
SyntaxError: invalid syntax
>>> ['Id', 'Nombre', 'Apellido', 'Area', 'Fecha comienzo', 'Fecha fin', 'Nivel', 'Grupo recruitment', 'Tiempo recruitment en semanas', 'Rango Salarial', 'RS competencia', 'Manager', 'Realizo Cursos', 'Id_Manager', 'Nombre_Manager', 'Apellido_Manager', 'sueldo en rublos desde', 'sueldo en rublos hasta', 'dias_trabajados', 'avg salario en rublos']
['Id', 'Nombre', 'Apellido', 'Area', 'Fecha comienzo', 'Fecha fin', 'Nivel', 'Grupo recruitment', 'Tiempo recruitment en semanas', 'Rango Salarial', 'RS competencia', 'Manager', 'Realizo Cursos', 'Id_Manager', 'Nombre_Manager', 'Apellido_Manager', 'sueldo en rublos desde', 'sueldo en rublos hasta', 'dias_trabajados', 'avg salario en rublos']
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> Thanks for sharing the column names. It seems there's no issue with the column name 'Grupo recruitment'. Since we've verified the column name and the SQL query syntax, let's consider other possible reasons for not getting any results.
  File "<stdin>", line 1
    Thanks for sharing the column names. It seems there's no issue with the column name 'Grupo recruitment'. Since we've verified the column name and the SQL query syntax, let's consider other possible reasons for not getting any results.
           ^
SyntaxError: invalid syntax
>>> 
>>> Here are a few things we could check:
  File "<stdin>", line 1
    Here are a few things we could check:
         ^
SyntaxError: invalid syntax
>>> 
>>> Data Content: Double-check the actual data in the DataFrame to ensure there are rows with 'Grupo recruitment' equal to 'A'.
  File "<stdin>", line 1
    Data Content: Double-check the actual data in the DataFrame to ensure there are rows with 'Grupo recruitment' equal to 'A'.
         ^
SyntaxError: invalid syntax
>>> Data Type: Ensure that the data type of the 'Grupo recruitment' column matches 'string'.
  File "<stdin>", line 1
    Data Type: Ensure that the data type of the 'Grupo recruitment' column matches 'string'.
         ^
SyntaxError: invalid syntax
>>> Whitespace: There might be leading or trailing whitespace in the 'Grupo recruitment' values causing the filter to not match. We can trim the values before filtering.
  File "<stdin>", line 1
    Whitespace: There might be leading or trailing whitespace in the 'Grupo recruitment' values causing the filter to not match. We can trim the values before filtering.
                      ^
SyntaxError: invalid syntax
>>> Let's explore these possibilities one by one. We can start by checking the data content of the 'Grupo recruitment' column to see if there are any unexpected values. Could you show a sample of the unique values in that column?
  File "<stdin>", line 1
    Let's explore these possibilities one by one. We can start by checking the data content of the 'Grupo recruitment' column to see if there are any unexpected values. Could you show a sample of the unique values in that column?
       ^
SyntaxError: invalid syntax
>>> 
>>> Whitespace: There might be leading or trailing whitespace in the 'Grupo recruitment' values causing the filter to not match. We can trim the values before filtering.
  File "<stdin>", line 1
    Whitespace: There might be leading or trailing whitespace in the 'Grupo recruitment' values causing the filter to not match. We can trim the values before filtering.
                      ^
SyntaxError: invalid syntax
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> That's a good point. Let's try trimming the values in the 'Grupo recruitment' column to remove any leading or trailing whitespace before filtering. We can use the trim() function from PySpark to achieve this.
  File "<stdin>", line 1
    That's a good point. Let's try trimming the values in the 'Grupo recruitment' column to remove any leading or trailing whitespace before filtering. We can use the trim() function from PySpark to achieve this.
        ^
SyntaxError: invalid syntax
>>> 
>>> Here's how we can do it:
  File "<stdin>", line 1
    Here's how we can do it:
                           ^
SyntaxError: EOL while scanning string literal
>>> 
>>> python
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'python' is not defined
>>> Copy code
  File "<stdin>", line 1
    Copy code
         ^
SyntaxError: invalid syntax
>>> from pyspark.sql.functions import col, trim
>>> >>> filtered_df = df_silver.filter(df_silver['Grupo recruitment'].isin('C'))
  File "<stdin>", line 1
    >>> filtered_df = df_silver.filter(df_silver['Grupo recruitment'].isin('C'))
    ^
SyntaxError: invalid syntax
>>> >>> filtered_df.show()
  File "<stdin>", line 1
    >>> filtered_df.show()
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> filtered_df = df_silver.where((df_silver['Grupo recruitment'] == 'C')
  File "<stdin>", line 1
    >>> filtered_df = df_silver.where((df_silver['Grupo recruitment'] == 'C')
    ^
SyntaxError: invalid syntax
>>> ... )
  File "<stdin>", line 1
    ... )
        ^
SyntaxError: unmatched ')'
>>> >>> filtered_df.show()
  File "<stdin>", line 1
    >>> filtered_df.show()
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> filtered_df = df_silver.where((df_silver['Grupo recruitment'] == 'A')
  File "<stdin>", line 1
    >>> filtered_df = df_silver.where((df_silver['Grupo recruitment'] == 'A')
    ^
SyntaxError: invalid syntax
>>> ... )
  File "<stdin>", line 1
    ... )
        ^
SyntaxError: unmatched ')'
>>> >>> filtered_df.show(5)
  File "<stdin>", line 1
    >>> filtered_df.show(5)
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> from pyspark.sql.functions import col
  File "<stdin>", line 1
    >>> from pyspark.sql.functions import col
    ^
SyntaxError: invalid syntax
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> # Find unique values in the 'Grupo recruitment' column
  File "<stdin>", line 1
    >>> # Find unique values in the 'Grupo recruitment' column
    ^
SyntaxError: invalid syntax
>>> >>> unique_values = df_silver.select('Grupo recruitment').distinct().rdd.map(lambda row: row[0]).collect()
  File "<stdin>", line 1
    >>> unique_values = df_silver.select('Grupo recruitment').distinct().rdd.map(lambda row: row[0]).collect()
    ^
SyntaxError: invalid syntax
>>> [Stage 56:>                                                  [Stage 58:>                                                                                                               >>>                
  File "<stdin>", line 1
    [Stage 56:>                                                  [Stage 58:>                                                                                                               >>>                
           ^
SyntaxError: invalid syntax
>>> >>> # Create an empty list to store DataFrames
  File "<stdin>", line 1
    >>> # Create an empty list to store DataFrames
    ^
SyntaxError: invalid syntax
>>> >>> dfs_per_value = []
  File "<stdin>", line 1
    >>> dfs_per_value = []
    ^
SyntaxError: invalid syntax
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> # Loop over unique values and filter DataFrame for each value
  File "<stdin>", line 1
    >>> # Loop over unique values and filter DataFrame for each value
    ^
SyntaxError: invalid syntax
>>> >>> for value in unique_values:
  File "<stdin>", line 1
    >>> for value in unique_values:
    ^
SyntaxError: invalid syntax
>>> ...     # Filter DataFrame for the current value
Ellipsis
>>> ...     filtered_df = df_silver.where(col('Grupo recruitment') == value)
  File "<stdin>", line 1
    ...     filtered_df = df_silver.where(col('Grupo recruitment') == value)
            ^
SyntaxError: invalid syntax
>>> ...     
Ellipsis
>>> ...     # Append filtered DataFrame to the list
Ellipsis
>>> ...     dfs_per_value.append(filtered_df)
  File "<stdin>", line 1
    ...     dfs_per_value.append(filtered_df)
            ^
SyntaxError: invalid syntax
>>> ... 
Ellipsis
>>> >>> # Show the list of DataFrames
  File "<stdin>", line 1
    >>> # Show the list of DataFrames
    ^
SyntaxError: invalid syntax
>>> >>> for idx, df in enumerate(dfs_per_value, start=1):
  File "<stdin>", line 1
    >>> for idx, df in enumerate(dfs_per_value, start=1):
    ^
SyntaxError: invalid syntax
>>> ...     print(f"DataFrame for unique value '{unique_values[idx - 1]}':")
  File "<stdin>", line 1
    ...     print(f"DataFrame for unique value '{unique_values[idx - 1]}':")
            ^
SyntaxError: invalid syntax
>>> ...     df.show()
  File "<stdin>", line 1
    ...     df.show()
            ^
SyntaxError: invalid syntax
>>> ... 
Ellipsis
>>> DataFrame for unique value ' C':
  File "<stdin>", line 1
    DataFrame for unique value ' C':
              ^
SyntaxError: invalid syntax
>>> +---+--------+---------+---------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+--------+---------+---------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                         ^
SyntaxError: invalid syntax
>>> | Id|  Nombre| Apellido|     Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|  Nombre| Apellido|     Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+--------+---------+---------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+--------+---------+---------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                         ^
SyntaxError: invalid syntax
>>> |  3|    Juan| Albornoz|       IT|    2018-06-04|2019-04-30|    4|                C|                            4|             4|             4|      5|            NO|         5|     Alejandro|        Pitorino|                300001|                350000|            330|             325000.5|
  File "<stdin>", line 1
    |  3|    Juan| Albornoz|       IT|    2018-06-04|2019-04-30|    4|                C|                            4|             4|             4|      5|            NO|         5|     Alejandro|        Pitorino|                300001|                350000|            330|             325000.5|
    ^
SyntaxError: invalid syntax
>>> |  5|  Franco|Rodrguez|Marketing|    2017-05-01|2017-11-30|    5|                C|                            6|             5|             4|      1|            SI|         1|       Rolando|           Casas|                350001|                400000|            213|             375000.5|
  File "<stdin>", line 1
    |  5|  Franco|Rodrguez|Marketing|    2017-05-01|2017-11-30|    5|                C|                            6|             5|             4|      1|            SI|         1|       Rolando|           Casas|                350001|                400000|            213|             375000.5|
    ^
SyntaxError: invalid syntax
>>> |  9| Nicolas| Martnez|       IT|    2021-01-04|2021-11-30|    2|                C|                            6|             3|             3|      5|            SI|         5|     Alejandro|        Pitorino|                250001|                300000|            330|             275000.5|
  File "<stdin>", line 1
    |  9| Nicolas| Martnez|       IT|    2021-01-04|2021-11-30|    2|                C|                            6|             3|             3|      5|            SI|         5|     Alejandro|        Pitorino|                250001|                300000|            330|             275000.5|
    ^
SyntaxError: invalid syntax
>>> | 12|    Luis|  Snchez|   Ventas|    2020-07-13|2020-12-31|    5|                C|                            5|             6|             6|      8|            NO|         8|       Ricardo|         Ronaldo|                400001|                500000|            171|             450000.5|
  File "<stdin>", line 1
    | 12|    Luis|  Snchez|   Ventas|    2020-07-13|2020-12-31|    5|                C|                            5|             6|             6|      8|            NO|         8|       Ricardo|         Ronaldo|                400001|                500000|            171|             450000.5|
    ^
SyntaxError: invalid syntax
>>> | 14|    Raul|   Garca|   Ventas|    2019-02-04|2020-03-31|    3|                C|                            6|             3|             3|      8|            SI|         8|       Ricardo|         Ronaldo|                250001|                300000|            421|             275000.5|
  File "<stdin>", line 1
    | 14|    Raul|   Garca|   Ventas|    2019-02-04|2020-03-31|    3|                C|                            6|             3|             3|      8|            SI|         8|       Ricardo|         Ronaldo|                250001|                300000|            421|             275000.5|
    ^
SyntaxError: invalid syntax
>>> | 16|  Vanina|  Bentez|       IT|    2019-08-05|2020-04-30|    5|                C|                            5|             6|             6|      5|            SI|         5|     Alejandro|        Pitorino|                400001|                500000|            269|             450000.5|
  File "<stdin>", line 1
    | 16|  Vanina|  Bentez|       IT|    2019-08-05|2020-04-30|    5|                C|                            5|             6|             6|      5|            SI|         5|     Alejandro|        Pitorino|                400001|                500000|            269|             450000.5|
    ^
SyntaxError: invalid syntax
>>> | 20| Marcelo|   Flores|   Ventas|    2021-09-06|2022-05-31|    2|                C|                            6|             2|             2|      8|            SI|         8|       Ricardo|         Ronaldo|                200001|                250000|            267|             225000.5|
  File "<stdin>", line 1
    | 20| Marcelo|   Flores|   Ventas|    2021-09-06|2022-05-31|    2|                C|                            6|             2|             2|      8|            SI|         8|       Ricardo|         Ronaldo|                200001|                250000|            267|             225000.5|
    ^
SyntaxError: invalid syntax
>>> | 21|Cristian|   Martin|  Compras|    2017-11-06|2020-12-31|    5|                C|                            4|             6|             5|      2|            SI|         2|        Marina|          Pitana|                400001|                500000|           1151|             450000.5|
  File "<stdin>", line 1
    | 21|Cristian|   Martin|  Compras|    2017-11-06|2020-12-31|    5|                C|                            4|             6|             5|      2|            SI|         2|        Marina|          Pitana|                400001|                500000|           1151|             450000.5|
    ^
SyntaxError: invalid syntax
>>> | 23|  Camila|   Prieto|       IT|    2022-01-03|2022-07-01|    6|                C|                            6|             6|             6|      5|            NO|         5|     Alejandro|        Pitorino|                400001|                500000|            179|             450000.5|
  File "<stdin>", line 1
    | 23|  Camila|   Prieto|       IT|    2022-01-03|2022-07-01|    6|                C|                            6|             6|             6|      5|            NO|         5|     Alejandro|        Pitorino|                400001|                500000|            179|             450000.5|
    ^
SyntaxError: invalid syntax
>>> | 29|   Dante|  Martini|       IT|    2021-03-01|2021-12-31|    4|                C|                            6|             3|             3|      5|            NO|         5|     Alejandro|        Pitorino|                250001|                300000|            305|             275000.5|
  File "<stdin>", line 1
    | 29|   Dante|  Martini|       IT|    2021-03-01|2021-12-31|    4|                C|                            6|             3|             3|      5|            NO|         5|     Alejandro|        Pitorino|                250001|                300000|            305|             275000.5|
    ^
SyntaxError: invalid syntax
>>> | 30|   Diego|    Buzos|Auditoria|    2021-09-06|2022-06-30|    1|                C|                            3|             1|             1|     10|            SI|        10|        Daniel|         Quiroga|                150000|                200000|            297|             175000.0|
  File "<stdin>", line 1
    | 30|   Diego|    Buzos|Auditoria|    2021-09-06|2022-06-30|    1|                C|                            3|             1|             1|     10|            SI|        10|        Daniel|         Quiroga|                150000|                200000|            297|             175000.0|
    ^
SyntaxError: invalid syntax
>>> +---+--------+---------+---------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+--------+---------+---------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                         ^
SyntaxError: invalid syntax
>>> 
>>> DataFrame for unique value ' B':
  File "<stdin>", line 1
    DataFrame for unique value ' B':
              ^
SyntaxError: invalid syntax
>>> +---+--------+--------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+--------+--------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                         ^
SyntaxError: invalid syntax
>>> | Id|  Nombre|Apellido|      Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|  Nombre|Apellido|      Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+--------+--------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+--------+--------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                         ^
SyntaxError: invalid syntax
>>> |  1|  Romina|   Brito| Marketing|    2018-03-05|2018-12-31|    3|                B|                            3|             3|             3|      1|            SI|         1|       Rolando|           Casas|                250001|                300000|            301|             275000.5|
  File "<stdin>", line 1
    |  1|  Romina|   Brito| Marketing|    2018-03-05|2018-12-31|    3|                B|                            3|             3|             3|      1|            SI|         1|       Rolando|           Casas|                250001|                300000|            301|             275000.5|
    ^
SyntaxError: invalid syntax
>>> |  2|   Pedro|   Lujan|   Compras|    2017-03-06|2021-12-31|    3|                B|                            3|             2|             2|      2|            SI|         2|        Marina|          Pitana|                200001|                250000|           1761|             225000.5|
  File "<stdin>", line 1
    |  2|   Pedro|   Lujan|   Compras|    2017-03-06|2021-12-31|    3|                B|                            3|             2|             2|      2|            SI|         2|        Marina|          Pitana|                200001|                250000|           1761|             225000.5|
    ^
SyntaxError: invalid syntax
>>> |  6|Catalina|   Gmez|Produccin|    2019-04-01|2022-03-31|    2|                B|                            4|             2|             2|      4|            NO|         4|        Miriam|          Pisani|                200001|                250000|           1095|             225000.5|
  File "<stdin>", line 1
    |  6|Catalina|   Gmez|Produccin|    2019-04-01|2022-03-31|    2|                B|                            4|             2|             2|      4|            NO|         4|        Miriam|          Pisani|                200001|                250000|           1095|             225000.5|
    ^
SyntaxError: invalid syntax
>>> | 11| Roberto|   Prez| Marketing|    2019-07-01|2022-04-30|    5|                B|                            5|             5|             5|      9|            SI|         9|        Vanina|        Quintana|                350001|                400000|           1034|             375000.5|
  File "<stdin>", line 1
    | 11| Roberto|   Prez| Marketing|    2019-07-01|2022-04-30|    5|                B|                            5|             5|             5|      9|            SI|         9|        Vanina|        Quintana|                350001|                400000|           1034|             375000.5|
    ^
SyntaxError: invalid syntax
>>> | 18|   Pedro|  Torres| Marketing|    2017-04-03|2019-12-31|    3|                B|                            4|             3|             3|      9|            SI|         9|        Vanina|        Quintana|                250001|                300000|           1002|             275000.5|
  File "<stdin>", line 1
    | 18|   Pedro|  Torres| Marketing|    2017-04-03|2019-12-31|    3|                B|                            4|             3|             3|      9|            SI|         9|        Vanina|        Quintana|                250001|                300000|           1002|             275000.5|
    ^
SyntaxError: invalid syntax
>>> | 22|  Matias| Bosques|    Ventas|    2018-12-03|2021-06-30|    4|                B|                            3|             4|             4|      8|            SI|         8|       Ricardo|         Ronaldo|                300001|                350000|            940|             325000.5|
  File "<stdin>", line 1
    | 22|  Matias| Bosques|    Ventas|    2018-12-03|2021-06-30|    4|                B|                            3|             4|             4|      8|            SI|         8|       Ricardo|         Ronaldo|                300001|                350000|            940|             325000.5|
    ^
SyntaxError: invalid syntax
>>> | 25|Carolina|Petersen|    Ventas|    2021-07-05|2022-02-28|    7|                B|                            4|             6|             6|      8|            SI|         8|       Ricardo|         Ronaldo|                400001|                500000|            238|             450000.5|
  File "<stdin>", line 1
    | 25|Carolina|Petersen|    Ventas|    2021-07-05|2022-02-28|    7|                B|                            4|             6|             6|      8|            SI|         8|       Ricardo|         Ronaldo|                400001|                500000|            238|             450000.5|
    ^
SyntaxError: invalid syntax
>>> | 26|  Fabian|  Quiroz|Produccin|    2018-05-07|2021-09-30|    3|                B|                            3|             2|             3|      6|            SI|         6|         Sonia|        Kamlasky|                200001|                250000|           1242|             225000.5|
  File "<stdin>", line 1
    | 26|  Fabian|  Quiroz|Produccin|    2018-05-07|2021-09-30|    3|                B|                            3|             2|             3|      6|            SI|         6|         Sonia|        Kamlasky|                200001|                250000|           1242|             225000.5|
    ^
SyntaxError: invalid syntax
>>> +---+--------+--------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+--------+--------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                         ^
SyntaxError: invalid syntax
>>> 
>>> DataFrame for unique value ' A':
  File "<stdin>", line 1
    DataFrame for unique value ' A':
              ^
SyntaxError: invalid syntax
>>> +---+---------+---------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+---------+---------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                           ^
SyntaxError: invalid syntax
>>> | Id|   Nombre| Apellido|      Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|   Nombre| Apellido|      Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+---------+---------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+---------+---------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                           ^
SyntaxError: invalid syntax
>>> |  4|Sebastian| Gonzlez|   Legales|    2018-05-07|2021-05-30|    2|                A|                            4|             2|             2|      3|            SI|         3|          Jos|        Feligres|                200001|                250000|           1119|             225000.5|
  File "<stdin>", line 1
    |  4|Sebastian| Gonzlez|   Legales|    2018-05-07|2021-05-30|    2|                A|                            4|             2|             2|      3|            SI|         3|          Jos|        Feligres|                200001|                250000|           1119|             225000.5|
    ^
SyntaxError: invalid syntax
>>> |  7| Anabella|Fernndez|    Ventas|    2020-07-06|2021-03-31|    4|                A|                            3|             4|             4|      8|            NO|         8|       Ricardo|         Ronaldo|                300001|                350000|            268|             325000.5|
  File "<stdin>", line 1
    |  7| Anabella|Fernndez|    Ventas|    2020-07-06|2021-03-31|    4|                A|                            3|             4|             4|      8|            NO|         8|       Ricardo|         Ronaldo|                300001|                350000|            268|             325000.5|
    ^
SyntaxError: invalid syntax
>>> |  8|Francesca|    Lpez|   Compras|    2017-01-02|2021-06-30|    3|                A|                            4|             3|             3|      2|            SI|         2|        Marina|          Pitana|                250001|                300000|           1640|             275000.5|
  File "<stdin>", line 1
--+--------------+-------+----------    |  8|Francesca|    Lpez|   Compras|    2017-01-02|2021-06-30|    3|                A|                            4|             3|             3|      2|            SI|         2|        Marina|          Pitana|                250001|                300000|           1640|             275000.5|
    ^
SyntaxError: invalid syntax
>>> | 10|      Ana|     Diaz|        IT|    2017-03-06|2020-11-30|    4|                A|                            3|             3|             3|      7|            NO|         7|        Martn|          Viglia|                250001|                300000|           1365|             275000.5|
  File "<stdin>", line 1
    | 10|      Ana|     Diaz|        IT|    2017-03-06|2020-11-30|    4|                A|                            3|             3|             3|      7|            NO|         7|        Martn|          Viglia|                250001|                300000|           1365|             275000.5|
    ^
SyntaxError: invalid syntax
>>> | 13|Alejandro|   Romero|        IT|    2020-06-01|2022-02-28|    3|                A|                            3|             4|             3|      7|            SI|         7|        Martn|          Viglia|                300001|                350000|            637|             325000.5|
  File "<stdin>", line 1
    | 13|Alejandro|   Romero|        IT|    2020-06-01|2022-02-28|    3|                A|                            3|             4|             3|      7|            SI|         7|        Martn|          Viglia|                300001|                350000|            637|             325000.5|
    ^
SyntaxError: invalid syntax
>>> | 15|   Analia|     Sosa|   Compras|    2018-10-01|2021-11-30|    4|                A|                            4|             4|             4|      2|            NO|         2|        Marina|          Pitana|                300001|                350000|           1156|             325000.5|
  File "<stdin>", line 1
    | 15|   Analia|     Sosa|   Compras|    2018-10-01|2021-11-30|    4|                A|                            4|             4|             4|      2|            NO|         2|        Marina|          Pitana|                300001|                350000|           1156|             325000.5|
    ^
SyntaxError: invalid syntax
>>> | 17|Guillermo|  Ramrez|        IT|    2020-01-06|2022-05-31|    2|                A|                            3|             2|             2|      7|            NO|         7|        Martn|          Viglia|                200001|                250000|            876|             225000.5|
  File "<stdin>", line 1
    | 17|Guillermo|  Ramrez|        IT|    2020-01-06|2022-05-31|    2|                A|                            3|             2|             2|      7|            NO|         7|        Martn|          Viglia|                200001|                250000|            876|             225000.5|
    ^
SyntaxError: invalid syntax
>>> | 19|    Rocio|     Ruiz| Auditoria|    2018-02-05|2021-01-30|    4|                A|                            4|             4|             5|     10|            NO|        10|        Daniel|         Quiroga|                300001|                350000|           1090|             325000.5|
  File "<stdin>", line 1
    | 19|    Rocio|     Ruiz| Auditoria|    2018-02-05|2021-01-30|    4|                A|                            4|             4|             5|     10|            NO|        10|        Daniel|         Quiroga|                300001|                350000|           1090|             325000.5|
    ^
SyntaxError: invalid syntax
>>> | 24|  Micaela|    Pauls|Produccin|    2019-01-07|2021-12-31|    6|                A|                            5|             6|             6|      4|            SI|         4|        Miriam|          Pisani|                400001|                500000|           1089|             450000.5|
  File "<stdin>", line 1
    | 24|  Micaela|    Pauls|Produccin|    2019-01-07|2021-12-31|    6|                A|                            5|             6|             6|      4|            SI|         4|        Miriam|          Pisani|                400001|                500000|           1089|             450000.5|
    ^
SyntaxError: invalid syntax
>>> | 27|  Rodrigo|  Molinas|   Compras|    2019-06-03|2022-04-30|    2|                A|                            4|             2|             2|      2|            SI|         2|        Marina|          Pitana|                200001|                250000|           1062|             225000.5|
  File "<stdin>", line 1
    | 27|  Rodrigo|  Molinas|   Compras|    2019-06-03|2022-04-30|    2|                A|                            4|             2|             2|      2|            SI|         2|        Marina|          Pitana|                200001|                250000|           1062|             225000.5|
    ^
SyntaxError: invalid syntax
>>> | 28|  Martina| Oliviera|Produccin|    2020-01-06|2022-06-30|    7|                A|                            4|             6|             6|      6|            SI|         6|         Sonia|        Kamlasky|                400001|                500000|            906|             450000.5|
  File "<stdin>", line 1
    | 28|  Martina| Oliviera|Produccin|    2020-01-06|2022-06-30|    7|                A|                            4|             6|             6|      6|            SI|         6|         Sonia|        Kamlasky|                400001|                500000|            906|             450000.5|
    ^
SyntaxError: invalid syntax
>>> +---+---------+---------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+---------+---------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                           ^
SyntaxError: invalid syntax
>>> 
>>> >>> from pyspark.sql.functions import col
  File "<stdin>", line 1
    >>> from pyspark.sql.functions import col
    ^
SyntaxError: invalid syntax
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> # Filter DataFrame for each unique value
  File "<stdin>", line 1
    >>> # Filter DataFrame for each unique value
    ^
SyntaxError: invalid syntax
>>> >>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
  File "<stdin>", line 1
    >>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
    ^
SyntaxError: invalid syntax
>>> >>> grupoB = df_silver.where(col('Grupo recruitment') == 'B')
  File "<stdin>", line 1
    >>> grupoB = df_silver.where(col('Grupo recruitment') == 'B')
    ^
SyntaxError: invalid syntax
>>> >>> grupoC = df_silver.where(col('Grupo recruitment') == 'C')
  File "<stdin>", line 1
    >>> grupoC = df_silver.where(col('Grupo recruitment') == 'C')
    ^
SyntaxError: invalid syntax
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> # Show the DataFrames
  File "<stdin>", line 1
    >>> # Show the DataFrames
    ^
SyntaxError: invalid syntax
>>> >>> print("DataFrame for unique value 'A':")
  File "<stdin>", line 1
    >>> print("DataFrame for unique value 'A':")
    ^
SyntaxError: invalid syntax
>>> DataFrame for unique value 'A':
  File "<stdin>", line 1
    DataFrame for unique value 'A':
              ^
SyntaxError: invalid syntax
>>> >>> grupoA.show()
  File "<stdin>", line 1
    >>> grupoA.show()
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> print("DataFrame for unique value 'B':")
  File "<stdin>", line 1
    >>> print("DataFrame for unique value 'B':")
    ^
SyntaxError: invalid syntax
>>> DataFrame for unique value 'B':
  File "<stdin>", line 1
    DataFrame for unique value 'B':
              ^
SyntaxError: invalid syntax
>>> >>> grupoB.show()
  File "<stdin>", line 1
    >>> grupoB.show()
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
------+---------------------+
|  4|Sebastian| Gonzlez|Legales|    2018-05-07|2021-05-30|    2|                A|                            4|             2|             2|      3|            SI|         3|          Jos|        Feligres|                200001|                250000|           1119|             225000.5|
|  7| Anabella|Fernndez| Venta                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> print("DataFrame for unique value 'C':")
  File "<stdin>", line 1
    >>> print("DataFrame for unique value 'C':")
    ^
SyntaxError: invalid syntax
>>> DataFrame for unique value 'C':
  File "<stdin>", line 1
    DataFrame for unique value 'C':
              ^
SyntaxError: invalid syntax
>>> >>> grupoC.show()
  File "<stdin>", line 1
    >>> grupoC.show()
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> grupoA = df_silver.where(col('Grupo recruitment') == A)
  File "<stdin>", line 1
    >>> grupoA = df_silver.where(col('Grupo recruitment') == A)
    ^
SyntaxError: invalid syntax
>>> Traceback (most recent call last):
  File "<stdin>", line 1
    Traceback (most recent call last):
                    ^
SyntaxError: invalid syntax
>>>   File "<stdin>", line 1, in <module>
  File "<stdin>", line 1
    File "<stdin>", line 1, in <module>
    ^
IndentationError: unexpected indent
>>> NameError: name 'A' is not defined
  File "<stdin>", line 1
    NameError: name 'A' is not defined
                    ^
SyntaxError: invalid syntax
>>> >>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
  File "<stdin>", line 1
    >>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
    ^
SyntaxError: invalid syntax
>>> >>> grupoA.show(3)
  File "<stdin>", line 1
    >>> grupoA.show(3)
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> distinct_values_A = df_silver.where(col('Grupo recruitment') == 'A').select('Grupo recruitment').distinct()
  File "<stdin>", line 1
    >>> distinct_values_A = df_silver.where(col('Grupo recruitment') == 'A').select('Grupo recruitment').distinct()
    ^
SyntaxError: invalid syntax
>>> >>> distinct_values_A.show(5)
  File "<stdin>", line 1
    >>> distinct_values_A.show(5)
    ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> |Grupo recruitment|
  File "<stdin>", line 1
    |Grupo recruitment|
    ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> 
>>> >>> df_silver.show(3)
  File "<stdin>", line 1
    >>> df_silver.show(3)
    ^
SyntaxError: invalid syntax
>>> +---+---------+---------+-------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+---------+---------+-------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                        ^
SyntaxError: invalid syntax
>>> | Id|   Nombre| Apellido|   Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|   Nombre| Apellido|   Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+---------+---------+-------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+---------+---------+-------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                        ^
SyntaxError: invalid syntax
>>> |  4|Sebastian| Gonzlez|Legales|    2018-05-07|2021-05-30|    2|                A|                            4|             2|             2|      3|            SI|         3|          Jos|        Feligres|                200001|                250000|           1119|             225000.5|
  File "<stdin>", line 1
    |  4|Sebastian| Gonzlez|Legales|    2018-05-07|2021-05-30|    2|                A|                            4|             2|             2|      3|            SI|         3|          Jos|        Feligres|                200001|                250000|           1119|             225000.5|
    ^
SyntaxError: invalid syntax
>>> |  7| Anabella|Fernndez| Ventas|    2020-07-06|2021-03-31|    4|                A|                            3|             4|             4|      8|            NO|         8|       Ricardo|         Ronaldo|                300001|                350000|            268|             325000.5|
  File "<stdin>", line 1
    |  7| Anabella|Fernndez| Ventas|    2020-07-06|2021-03-31|    4|                A|                            3|             4|             4|      8|            NO|         8|       Ricardo|         Ronaldo|                300001|                350000|            268|             325000.5|
    ^
SyntaxError: invalid syntax
>>> |  8|Francesca|    Lpez|Compras|    2017-01-02|2021-06-30|    3|                A|                            4|             3|             3|      2|            SI|         2|        Marina|          Pitana|                250001|                300000|           1640|             275000.5|
  File "<stdin>", line 1
    |  8|Francesca|    Lpez|Compras|    2017-01-02|2021-06-30|    3|                A|                            4|             3|             3|      2|            SI|         2|        Marina|          Pitana|                250001|                300000|           1640|             275000.5|
    ^
SyntaxError: invalid syntax
>>> +---+---------+---------+-------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+---------+---------+-------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                        ^
SyntaxError: invalid syntax
>>> only showing top 3 rows
  File "<stdin>", line 1
    only showing top 3 rows
         ^
SyntaxError: invalid syntax
>>> 
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> It seems like you're trying to filter your DataFrame by unique values in the 'Grupo recruitment' column in Apache Spark. Let's review the steps you've taken:
  File "<stdin>", line 1
    It seems like you're trying to filter your DataFrame by unique values in the 'Grupo recruitment' column in Apache Spark. Let's review the steps you've taken:
       ^
SyntaxError: invalid syntax
>>> 
>>> You used the where method to filter the DataFrame for each unique value in the 'Grupo recruitment' column. You also tried using the filter method with the isin function, but it didn't return any rows for the specified condition.
  File "<stdin>", line 1
    You used the where method to filter the DataFrame for each unique value in the 'Grupo recruitment' column. You also tried using the filter method with the isin function, but it didn't return any rows for the specified condition.
        ^
SyntaxError: invalid syntax
>>> Then, you attempted to extract unique values in the 'Grupo recruitment' column using Spark SQL functions, which returned an empty DataFrame for value 'A'. This might indicate that there are no rows with 'A' in the 'Grupo recruitment' column.
  File "<stdin>", line 1
    Then, you attempted to extract unique values in the 'Grupo recruitment' column using Spark SQL functions, which returned an empty DataFrame for value 'A'. This might indicate that there are no rows with 'A' in the 'Grupo recruitment' column.
              ^
SyntaxError: invalid syntax
>>> You also attempted to filter the DataFrame by explicitly specifying the value 'A' without quotes, which resulted in a NameError because 'A' wasn't defined as a variable.
  File "<stdin>", line 1
    You also attempted to filter the DataFrame by explicitly specifying the value 'A' without quotes, which resulted in a NameError because 'A' wasn't defined as a variable.
        ^
SyntaxError: invalid syntax
>>> Finally, you displayed the entire DataFrame to review its contents.
  File "<stdin>", line 1
    Finally, you displayed the entire DataFrame to review its contents.
                 ^
SyntaxError: invalid syntax
>>> From the provided code and outputs, it appears that there might be no rows with the value 'A' in the 'Grupo recruitment' column. You may want to verify the data and ensure that the values you're filtering for exist in the DataFrame.
  File "<stdin>", line 1
    From the provided code and outputs, it appears that there might be no rows with the value 'A' in the 'Grupo recruitment' column. You may want to verify the data and ensure that the values you're filtering for exist in the DataFrame.
         ^
SyntaxError: invalid syntax
>>> 
>>> only showing top 3 rows
  File "<stdin>", line 1
    only showing top 3 rows
         ^
SyntaxError: invalid syntax
>>> 
>>> >>> df_silver.select('Grupo recruitment').show(3)
  File "<stdin>", line 1
    >>> df_silver.select('Grupo recruitment').show(3)
    ^
SyntaxError: invalid syntax
>>> +-----------------+                                                             
  File "<stdin>", line 1
    +-----------------+                                                             
                                                                                   ^
SyntaxError: invalid syntax
>>> |Grupo recruitment|
  File "<stdin>", line 1
    |Grupo recruitment|
    ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> |                A|
  File "<stdin>", line 1
    |                A|
    ^
SyntaxError: invalid syntax
>>> |                A|
  File "<stdin>", line 1
    |                A|
    ^
SyntaxError: invalid syntax
>>> |                A|
  File "<stdin>", line 1
    |                A|
    ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> only showing top 3 rows
  File "<stdin>", line 1
    only showing top 3 rows
         ^
SyntaxError: invalid syntax
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> It seems like there are indeed rows with the value 'A' in the 'Grupo recruitment' column, as shown by the output of df_silver.select('Grupo recruitment').show(3).
  File "<stdin>", line 1
    It seems like there are indeed rows with the value 'A' in the 'Grupo recruitment' column, as shown by the output of df_silver.select('Grupo recruitment').show(3).
       ^
SyntaxError: invalid syntax
>>> 
->>> Given that there are rows with 'A' in the 'Grupo recruitment' column, the empty result when filtering for 'A' might indicate a data inconsistency or an issue with the filtering condition. Let's double-check the filtering process to ensure it's correctly implemented. Could you please provide the specific code snippet where you're filtering for the 'A' value so that we can investigate further?
  File "<stdin>", line 1
    Given that there are rows with 'A' in the 'Grupo recruitment' column, the empty result when filtering for 'A' might indicate a data inconsistency or an issue with the filtering condition. Let's double-check the filtering process to ensure it's correctly implemented. Could you please provide the specific code snippet where you're filtering for the 'A' value so that we can investigate further?
          ^
SyntaxError: invalid syntax
>>> 
=>>> >>> from pyspark.sql.functions import col
  File "<stdin>", line 1
    >>> from pyspark.sql.functions import col
    ^
SyntaxError: invalid syntax
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> # Filter DataFrame for each unique value
  File "<stdin>", line 1
    >>> # Filter DataFrame for each unique value
    ^
SyntaxError: invalid syntax
>>> >>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
  File "<stdin>", line 1
    >>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
    ^
SyntaxError: invalid syntax
>>> >>> grupoB = df_silver.where(col('Grupo recruitment') == 'B')
  File "<stdin>", line 1
    >>> grupoB = df_silver.where(col('Grupo recruitment') == 'B')
    ^
SyntaxError: invalid syntax
>>> >>> grupoC = df_silver.where(col('Grupo recruitment') == 'C')
  File "<stdin>", line 1
    >>> grupoC = df_silver.where(col('Grupo recruitment') == 'C')
    ^
SyntaxError: invalid syntax
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> # Show the DataFrames
  File "<stdin>", line 1
    >>> # Show the DataFrames
    ^
SyntaxError: invalid syntax
>>> >>> print("DataFrame for unique value 'A':")
  File "<stdin>", line 1
    >>> print("DataFrame for unique value 'A':")
    ^
SyntaxError: invalid syntax
>>> DataFrame for unique value 'A':
  File "<stdin>", line 1
    DataFrame for unique value 'A':
              ^
SyntaxError: invalid syntax
>>> >>> grupoA.show()
  File "<stdin>", line 1
    >>> grupoA.show()
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> print("DataFrame for unique value 'B':")
  File "<stdin>", line 1
    >>> print("DataFrame for unique value 'B':")
    ^
SyntaxError: invalid syntax
>>> DataFrame for unique value 'B':
  File "<stdin>", line 1
    DataFrame for unique value 'B':
              ^
SyntaxError: invalid syntax
>>> >>> grupoB.show()
  File "<stdin>", line 1
    >>> grupoB.show()
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> print("DataFrame for unique value 'C':")
  File "<stdin>", line 1
    >>> print("DataFrame for unique value 'C':")
    ^
SyntaxError: invalid syntax
>>> DataFrame for unique value 'C':
  File "<stdin>", line 1
    DataFrame for unique value 'C':
              ^
SyntaxError: invalid syntax
>>> >>> grupoC.show()
  File "<stdin>", line 1
    >>> grupoC.show()
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> grupoA = df_silver.where(col('Grupo recruitment') == A)
  File "<stdin>", line 1
    >>> grupoA = df_silver.where(col('Grupo recruitment') == A)
    ^
SyntaxError: invalid syntax
>>> Traceback (most recent call last):
  File "<stdin>", line 1
    Traceback (most recent call last):
                    ^
SyntaxError: invalid syntax
>>>   File "<stdin>", line 1, in <module>
  File "<stdin>", line 1
    File "<stdin>", line 1, in <module>
    ^
IndentationError: unexpected indent
>>> NameError: name 'A' is not defined
  File "<stdin>", line 1
    NameError: name 'A' is not defined
                    ^
SyntaxError: invalid syntax
>>> >>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
  File "<stdin>", line 1
    >>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
    ^
SyntaxError: invalid syntax
>>> >>> grupoA.show(3)
  File "<stdin>", line 1
    >>> grupoA.show(3)
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> It appears that there are no data rows in the DataFrames grupoA, grupoB, and grupoC. This suggests that there might be no records in the original DataFrame df_silver that match the conditions for each group ('A', 'B', and 'C').
  File "<stdin>", line 1
    It appears that there are no data rows in the DataFrames grupoA, grupoB, and grupoC. This suggests that there might be no records in the original DataFrame df_silver that match the conditions for each group ('A', 'B', and 'C').
       ^
SyntaxError: invalid syntax
>>> 
>>> To confirm this, you can try to count the number of rows in each DataFrame. For example:
  File "<stdin>", line 1
    To confirm this, you can try to count the number of rows in each DataFrame. For example:
       ^
SyntaxError: invalid syntax
>>> 
>>> python
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'python' is not defined
>>> Copy code
  File "<stdin>", line 1
    Copy code
         ^
SyntaxError: invalid syntax
>>> print("Number of rows in DataFrame for unique value 'A':", grupoA.count())
Number of rows in DataFrame for unique value 'A': 0
>>> print("Number of rows in DataFrame for unique value 'B':", grupoB.count())
Number of rows in DataFrame for unique value 'B': 0
>>> print("Number of rows in DataFrame for unique value 'C':", grupoC.count())
Number of rows in DataFrame for unique value 'C': 0
>>> This will give you the count of rows for each DataFrame, helping to verify if there are indeed no records matching the conditions. If there are records, it might be necessary to review the filtering conditions or the data itself to understand why they are not being captured.
  File "<stdin>", line 1
    This will give you the count of rows for each DataFrame, helping to verify if there are indeed no records matching the conditions. If there are records, it might be necessary to review the filtering conditions or the data itself to understand why they are not being captured.
         ^
SyntaxError: invalid syntax
>>> 
>>> >>> print("Number of rows in DataFrame for unique value 'A':", grupoA.count())
  File "<stdin>", line 1
    >>> print("Number of rows in DataFrame for unique value 'A':", grupoA.count())
    ^
SyntaxError: invalid syntax
>>> Number of rows in DataFrame for unique value 'A': 0      
  File "<stdin>", line 1
    Number of rows in DataFrame for unique value 'A': 0      
           ^
SyntaxError: invalid syntax
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> As suspected, the DataFrame for the unique value 'A' is empty, which means there are no records in df_silver where the "Grupo recruitment" column value is 'A'.
  File "<stdin>", line 1
    As suspected, the DataFrame for the unique value 'A' is empty, which means there are no records in df_silver where the "Grupo recruitment" column value is 'A'.
       ^
SyntaxError: invalid syntax
>>> 
>>> This result suggests that there might be no employees in group 'A' in your dataset. You might want to review your data or the criteria used for filtering to ensure it matches your expectations. If you expected to have employees in group 'A', you might need to double-check the data or the condition used for filtering.
  File "<stdin>", line 1
    This result suggests that there might be no employees in group 'A' in your dataset. You might want to review your data or the criteria used for filtering to ensure it matches your expectations. If you expected to have employees in group 'A', you might need to double-check the data or the condition used for filtering.
         ^
SyntaxError: invalid syntax
>>> 
>>> grupoA = df_silver.where(col('Grupo recruitment') == 'A')
>>> this with python in pyspark
  File "<stdin>", line 1
    this with python in pyspark
         ^
SyntaxError: invalid syntax
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> Yes, the line grupoA = df_silver.where(col('Grupo recruitment') == 'A') is indeed Python code written in PySpark.
  File "<stdin>", line 1
    Yes, the line grupoA = df_silver.where(col('Grupo recruitment') == 'A') is indeed Python code written in PySpark.
             ^
SyntaxError: invalid syntax
>>> 
>>> Here's a breakdown of what it does:
  File "<stdin>", line 1
    Here's a breakdown of what it does:
                                      ^
SyntaxError: EOL while scanning string literal
>>> 
>>> df_silver: This is assumed to be a DataFrame in PySpark. The name suggests it contains data related to silver, but the actual content would depend on your specific application.
  File "<stdin>", line 1
    df_silver: This is assumed to be a DataFrame in PySpark. The name suggests it contains data related to silver, but the actual content would depend on your specific application.
                               ^
SyntaxError: invalid syntax
>>> .where(): This method is used to filter rows based on a condition. It takes a predicate (a condition) as an argument and returns a new DataFrame containing only the rows for which the condition is true.
  File "<stdin>", line 1
    .where(): This method is used to filter rows based on a condition. It takes a predicate (a condition) as an argument and returns a new DataFrame containing only the rows for which the condition is true.
    ^
SyntaxError: invalid syntax
>>> col('Grupo recruitment'): This refers to the "Grupo recruitment" column in the DataFrame. The col() function is used to create a Column object representing a column in the DataFrame.
  File "<stdin>", line 1
    col('Grupo recruitment'): This refers to the "Grupo recruitment" column in the DataFrame. The col() function is used to create a Column object representing a column in the DataFrame.
                                   ^
SyntaxError: invalid syntax
>>> == 'A': This is the condition being applied. It checks if the value in the "Grupo recruitment" column is equal to 'A'.
  File "<stdin>", line 1
    == 'A': This is the condition being applied. It checks if the value in the "Grupo recruitment" column is equal to 'A'.
    ^
SyntaxError: invalid syntax
>>> So, overall, this line of code filters the DataFrame df_silver to only include rows where the value in the "Grupo recruitment" column is 'A', and assigns the result to the variable grupoA.
  File "<stdin>", line 1
    So, overall, this line of code filters the DataFrame df_silver to only include rows where the value in the "Grupo recruitment" column is 'A', and assigns the result to the variable grupoA.
                      ^
SyntaxError: invalid syntax
>>> 
>>> do it with a view using sql
  File "<stdin>", line 1
    do it with a view using sql
       ^
SyntaxError: invalid syntax
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> Sure, you can achieve the same filtering using SQL syntax in PySpark by creating a temporary view and then executing SQL queries on that view. Here's how you can do it:
  File "<stdin>", line 1
    Sure, you can achieve the same filtering using SQL syntax in PySpark by creating a temporary view and then executing SQL queries on that view. Here's how you can do it:
              ^
SyntaxError: invalid syntax
>>> 
>>> python
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'python' is not defined
>>> Copy code
  File "<stdin>", line 1
    Copy code
         ^
SyntaxError: invalid syntax
>>> # Register DataFrame as a temporary view
>>> df_silver.createOrReplaceTempView("silver_view")
>>> 
>>> # Execute SQL query to filter rows where 'Grupo recruitment' is 'A'
>>> grupoA = spark.sql("SELECT * FROM silver_view WHERE `Grupo recruitment` = 'A'")
>>> 
>>> # Show the resulting DataFrame
>>> grupoA.show()
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> This code performs the following steps:
  File "<stdin>", line 1
    This code performs the following steps:
         ^
SyntaxError: invalid syntax
>>> 
>>> It registers the DataFrame df_silver as a temporary view named "silver_view" using the createOrReplaceTempView() method. This allows you to refer to the DataFrame using SQL syntax.
  File "<stdin>", line 1
    It registers the DataFrame df_silver as a temporary view named "silver_view" using the createOrReplaceTempView() method. This allows you to refer to the DataFrame using SQL syntax.
       ^
SyntaxError: invalid syntax
>>> It executes an SQL query using spark.sql(), which filters the rows from the "silver_view" where the value of the "Grupo recruitment" column is 'A'.
  File "<stdin>", line 1
    It executes an SQL query using spark.sql(), which filters the rows from the "silver_view" where the value of the "Grupo recruitment" column is 'A'.
       ^
SyntaxError: invalid syntax
>>> Finally, it shows the resulting DataFrame using the show() method.
  File "<stdin>", line 1
    Finally, it shows the resulting DataFrame using the show() method.
                ^
SyntaxError: invalid syntax
>>> This achieves the same result as filtering using the DataFrame API, but using SQL syntax instead.
  File "<stdin>", line 1
    This achieves the same result as filtering using the DataFrame API, but using SQL syntax instead.
         ^
SyntaxError: invalid syntax
>>> 
>>> >>> df_silver.select('Grupo recruitment').show(3)
  File "<stdin>", line 1
    >>> df_silver.select('Grupo recruitment').show(3)
    ^
SyntaxError: invalid syntax
>>> +-----------------+                                                             
  File "<stdin>", line 1
    +-----------------+                                                             
                                                                                   ^
SyntaxError: invalid syntax
>>> |Grupo recruitment|
  File "<stdin>", line 1
    |Grupo recruitment|
    ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> |                A|
  File "<stdin>", line 1
    |                A|
    ^
SyntaxError: invalid syntax
>>> |                A|
  File "<stdin>", line 1
    |                A|
    ^
SyntaxError: invalid syntax
>>> |                A|
  File "<stdin>", line 1
    |                A|
    ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> only showing top 3 rows
  File "<stdin>", line 1
    only showing top 3 rows
         ^
SyntaxError: invalid syntax
>>> 
>>> >>> print("Number of rows in DataFrame for unique value 'A':", grupoA.count())
  File "<stdin>", line 1
    >>> print("Number of rows in DataFrame for unique value 'A':", grupoA.count())
    ^
SyntaxError: invalid syntax
>>> Number of rows in DataFrame for unique value 'A': 0                             
  File "<stdin>", line 1
    Number of rows in DataFrame for unique value 'A': 0                             
           ^
SyntaxError: invalid syntax
>>> >>> df_silver.createOrReplaceTempView("silver_view")
  File "<stdin>", line 1
    >>> df_silver.createOrReplaceTempView("silver_view")
    ^
SyntaxError: invalid syntax
>>> >>> grupoA = spark.sql("SELECT * FROM silver_view WHERE `Grupo recruitment` = 'A'")
  File "<stdin>", line 1
    >>> grupoA = spark.sql("SELECT * FROM silver_view WHERE `Grupo recruitment` = 'A'")
    ^
SyntaxError: invalid syntax
>>> >>> grupoA.show()
  File "<stdin>", line 1
    >>> grupoA.show()
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> df_silver.select('Grupo recruitment').show(3)
  File "<stdin>", line 1
    >>> df_silver.select('Grupo recruitment').show(3)
    ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> |Grupo recruitment|
  File "<stdin>", line 1
    |Grupo recruitment|
    ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> |                A|
  File "<stdin>", line 1
    |                A|
    ^
SyntaxError: invalid syntax
>>> |                A|
  File "<stdin>", line 1
    |                A|
    ^
SyntaxError: invalid syntax
>>> |                A|
  File "<stdin>", line 1
    |                A|
    ^
SyntaxError: invalid syntax
>>> +-----------------+
  File "<stdin>", line 1
    +-----------------+
                      ^
SyntaxError: invalid syntax
>>> only showing top 3 rows
  File "<stdin>", line 1
    only showing top 3 rows
         ^
SyntaxError: invalid syntax
>>> 
>>> >>> df_silver.printSchema()
  File "<stdin>", line 1
    >>> df_silver.printSchema()
    ^
SyntaxError: invalid syntax
>>> root
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'root' is not defined
>>>  |-- Id: integer (nullable = true)
  File "<stdin>", line 1
    |-- Id: integer (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Nombre: string (nullable = true)
  File "<stdin>", line 1
    |-- Nombre: string (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Apellido: string (nullable = true)
  File "<stdin>", line 1
    |-- Apellido: string (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Area: string (nullable = true)
  File "<stdin>", line 1
    |-- Area: string (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Fecha comienzo: date (nullable = true)
  File "<stdin>", line 1
    |-- Fecha comienzo: date (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Fecha fin: date (nullable = true)
  File "<stdin>", line 1
    |-- Fecha fin: date (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Nivel: integer (nullable = true)
  File "<stdin>", line 1
    |-- Nivel: integer (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Grupo recruitment: string (nullable = true)
  File "<stdin>", line 1
    |-- Grupo recruitment: string (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Tiempo recruitment en semanas: integer (nullable = true)
  File "<stdin>", line 1
    |-- Tiempo recruitment en semanas: integer (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Rango Salarial: integer (nullable = true)
  File "<stdin>", line 1
    |-- Rango Salarial: integer (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- RS competencia: integer (nullable = true)
  File "<stdin>", line 1
    |-- RS competencia: integer (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Manager: string (nullable = true)
  File "<stdin>", line 1
    |-- Manager: string (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Realizo Cursos: string (nullable = true)
  File "<stdin>", line 1
    |-- Realizo Cursos: string (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Id_Manager: string (nullable = true)
  File "<stdin>", line 1
    |-- Id_Manager: string (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Nombre_Manager: string (nullable = true)
  File "<stdin>", line 1
    |-- Nombre_Manager: string (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- Apellido_Manager: string (nullable = true)
  File "<stdin>", line 1
    |-- Apellido_Manager: string (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- sueldo en rublos desde: integer (nullable = true)
  File "<stdin>", line 1
    |-- sueldo en rublos desde: integer (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- sueldo en rublos hasta: integer (nullable = true)
  File "<stdin>", line 1
    |-- sueldo en rublos hasta: integer (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- dias_trabajados: integer (nullable = true)
  File "<stdin>", line 1
    |-- dias_trabajados: integer (nullable = true)
    ^
IndentationError: unexpected indent
>>>  |-- avg salario en rublos: double (nullable = true)
  File "<stdin>", line 1
    |-- avg salario en rublos: double (nullable = true)
    ^
IndentationError: unexpected indent
>>> 
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> It seems that the DataFrame grupoA is empty, even though there are rows with 'Grupo recruitment' equal to 'A' in the original DataFrame df_silver. Let's debug this together.
  File "<stdin>", line 1
    It seems that the DataFrame grupoA is empty, even though there are rows with 'Grupo recruitment' equal to 'A' in the original DataFrame df_silver. Let's debug this together.
       ^
SyntaxError: invalid syntax
>>> 
>>> First, let's check if there are actually rows in df_silver where 'Grupo recruitment' is 'A' by filtering it directly:
  File "<stdin>", line 1
    First, let's check if there are actually rows in df_silver where 'Grupo recruitment' is 'A' by filtering it directly:
              ^
SyntaxError: invalid syntax
>>> 
>>> python
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'python' is not defined
>>> Copy code
  File "<stdin>", line 1
    Copy code
         ^
SyntaxError: invalid syntax
>>> df_silver.filter(df_silver['Grupo recruitment'] == 'A').show()
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> If this shows rows, then there might be an issue with how we're filtering when using SQL. Let's ensure there are no typos or issues with column names by listing the columns:
  File "<stdin>", line 1
    If this shows rows, then there might be an issue with how we're filtering when using SQL. Let's ensure there are no typos or issues with column names by listing the columns:
       ^
SyntaxError: invalid syntax
>>> 
>>> python
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'python' is not defined
>>> Copy code
  File "<stdin>", line 1
    Copy code
         ^
SyntaxError: invalid syntax
>>> df_silver.columns
['Id', 'Nombre', 'Apellido', 'Area', 'Fecha comienzo', 'Fecha fin', 'Nivel', 'Grupo recruitment', 'Tiempo recruitment en semanas', 'Rango Salarial', 'RS competencia', 'Manager', 'Realizo Cursos', 'Id_Manager', 'Nombre_Manager', 'Apellido_Manager', 'sueldo en rublos desde', 'sueldo en rublos hasta', 'dias_trabajados', 'avg salario en rublos']
>>> This will display all the column names in df_silver, which you can use to ensure accuracy in your SQL query. If everything looks fine, we can proceed with further troubleshooting. Let me know what you find!
  File "<stdin>", line 1
    This will display all the column names in df_silver, which you can use to ensure accuracy in your SQL query. If everything looks fine, we can proceed with further troubleshooting. Let me know what you find!
         ^
SyntaxError: invalid syntax
>>> 
>>> >>> df_silver.filter(df_silver['Grupo recruitment'] == 'A').show()
  File "<stdin>", line 1
    >>> df_silver.filter(df_silver['Grupo recruitment'] == 'A').show()
    ^
SyntaxError: invalid syntax
>>> 
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
  File "<stdin>", line 1
    | Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
    ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
  File "<stdin>", line 1
    +---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
                                                                                                                                                                                                                                                                                                ^
SyntaxError: invalid syntax
>>> 
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> >>> 
  File "<stdin>", line 1
    >>> 
    ^
SyntaxError: invalid syntax
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> It seems there are indeed rows in df_silver where 'Grupo recruitment' is 'A'. Since we're not getting any results when filtering with SQL, let's double-check the column name and ensure there are no issues there.
  File "<stdin>", line 1
    It seems there are indeed rows in df_silver where 'Grupo recruitment' is 'A'. Since we're not getting any results when filtering with SQL, let's double-check the column name and ensure there are no issues there.
       ^
SyntaxError: invalid syntax
>>> 
>>> You've printed the schema earlier, so we know the column name is correct. Let's verify the syntax for the SQL query and the backticks around column names, just to be sure:
  File "<stdin>", line 1
    You've printed the schema earlier, so we know the column name is correct. Let's verify the syntax for the SQL query and the backticks around column names, just to be sure:
       ^
SyntaxError: invalid syntax
>>> 
>>> python
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'python' is not defined
>>> Copy code
  File "<stdin>", line 1
    Copy code
         ^
SyntaxError: invalid syntax
>>> grupoA = spark.sql("SELECT * FROM silver_view WHERE `Grupo recruitment` = 'A'")
>>> If everything seems correct, we might need to investigate further. Let me know if you find anything!
  File "<stdin>", line 1
    If everything seems correct, we might need to investigate further. Let me know if you find anything!
       ^
SyntaxError: invalid syntax
>>> 
>>> >>> df_silver.columns
  File "<stdin>", line 1
    >>> df_silver.columns
    ^
SyntaxError: invalid syntax
>>> ['Id', 'Nombre', 'Apellido', 'Area', 'Fecha comienzo', 'Fecha fin', 'Nivel', 'Grupo recruitment', 'Tiempo recruitment en semanas', 'Rango Salarial', 'RS competencia', 'Manager', 'Realizo Cursos', 'Id_Manager', 'Nombre_Manager', 'Apellido_Manager', 'sueldo en rublos desde', 'sueldo en rublos hasta', 'dias_trabajados', 'avg salario en rublos']
['Id', 'Nombre', 'Apellido', 'Area', 'Fecha comienzo', 'Fecha fin', 'Nivel', 'Grupo recruitment', 'Tiempo recruitment en semanas', 'Rango Salarial', 'RS competencia', 'Manager', 'Realizo Cursos', 'Id_Manager', 'Nombre_Manager', 'Apellido_Manager', 'sueldo en rublos desde', 'sueldo en rublos hasta', 'dias_trabajados', 'avg salario en rublos']
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> Thanks for sharing the column names. It seems there's no issue with the column name 'Grupo recruitment'. Since we've verified the column name and the SQL query syntax, let's consider other possible reasons for not getting any results.
  File "<stdin>", line 1
    Thanks for sharing the column names. It seems there's no issue with the column name 'Grupo recruitment'. Since we've verified the column name and the SQL query syntax, let's consider other possible reasons for not getting any results.
           ^
SyntaxError: invalid syntax
>>> 
>>> Here are a few things we could check:
  File "<stdin>", line 1
    Here are a few things we could check:
         ^
SyntaxError: invalid syntax
>>> 
>>> Data Content: Double-check the actual data in the DataFrame to ensure there are rows with 'Grupo recruitment' equal to 'A'.
  File "<stdin>", line 1
    Data Content: Double-check the actual data in the DataFrame to ensure there are rows with 'Grupo recruitment' equal to 'A'.
         ^
SyntaxError: invalid syntax
>>> Data Type: Ensure that the data type of the 'Grupo recruitment' column matches 'string'.
  File "<stdin>", line 1
    Data Type: Ensure that the data type of the 'Grupo recruitment' column matches 'string'.
         ^
SyntaxError: invalid syntax
>>> Whitespace: There might be leading or trailing whitespace in the 'Grupo recruitment' values causing the filter to not match. We can trim the values before filtering.
  File "<stdin>", line 1
    Whitespace: There might be leading or trailing whitespace in the 'Grupo recruitment' values causing the filter to not match. We can trim the values before filtering.
                      ^
SyntaxError: invalid syntax
>>> Let's explore these possibilities one by one. We can start by checking the data content of the 'Grupo recruitment' column to see if there are any unexpected values. Could you show a sample of the unique values in that column?
  File "<stdin>", line 1
    Let's explore these possibilities one by one. We can start by checking the data content of the 'Grupo recruitment' column to see if there are any unexpected values. Could you show a sample of the unique values in that column?
       ^
SyntaxError: invalid syntax
>>> 
>>> Whitespace: There might be leading or trailing whitespace in the 'Grupo recruitment' values causing the filter to not match. We can trim the values before filtering.
  File "<stdin>", line 1
    Whitespace: There might be leading or trailing whitespace in the 'Grupo recruitment' values causing the filter to not match. We can trim the values before filtering.
                      ^
SyntaxError: invalid syntax
>>> ChatGPT
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ChatGPT' is not defined
>>> That's a good point. Let's try trimming the values in the 'Grupo recruitment' column to remove any leading or trailing whitespace before filtering. We can use the trim() function from PySpark to achieve this.
  File "<stdin>", line 1
    That's a good point. Let's try trimming the values in the 'Grupo recruitment' column to remove any leading or trailing whitespace before filtering. We can use the trim() function from PySpark to achieve this.
        ^
SyntaxError: invalid syntax
>>> 
>>> Here's how we can do it:
  File "<stdin>", line 1
    Here's how we can do it:
                           ^
SyntaxError: EOL while scanning string literal
>>> 
>>> python
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'python' is not defined
>>> Copy code
  File "<stdin>", line 1
    Copy code
         ^
SyntaxError: invalid syntax
>>> Copy codefrom pyspark.sql.functions import col, trim
  File "<stdin>", line 1
    Copy codefrom pyspark.sql.functions import col, trim
         ^
SyntaxError: invalid syntax
>>> from pyspark.sql.functions import col, trim
>>> df_silver = df_silver.withColumn('Grupo recruitment', trim(col('Grupo recruitment')))
>>> grupoA = df_silver.filter(df_silver['Grupo recruitment'] == 'A')
>>> grupoA.show()
+---+---------+---------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|   Nombre| Apellido|      Area|Fecha comienzo| Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+---------+---------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
|  4|Sebastian| Gonzlez|   Legales|    2018-05-07|2021-05-30|    2|                A|                            4|             2|             2|      3|            SI|         3|          Jos|        Feligres|                200001|                250000|           1119|             225000.5|
|  7| Anabella|Fernndez|    Ventas|    2020-07-06|2021-03-31|    4|                A|                            3|             4|             4|      8|            NO|         8|       Ricardo|         Ronaldo|                300001|                350000|            268|             325000.5|
|  8|Francesca|    Lpez|   Compras|    2017-01-02|2021-06-30|    3|                A|                            4|             3|             3|      2|            SI|         2|        Marina|          Pitana|                250001|                300000|           1640|             275000.5|
| 10|      Ana|     Diaz|        IT|    2017-03-06|2020-11-30|    4|                A|                            3|             3|             3|      7|            NO|         7|        Martn|          Viglia|                250001|                300000|           1365|             275000.5|
| 13|Alejandro|   Romero|        IT|    2020-06-01|2022-02-28|    3|                A|                            3|             4|             3|      7|            SI|         7|        Martn|          Viglia|                300001|                350000|            637|             325000.5|
| 15|   Analia|     Sosa|   Compras|    2018-10-01|2021-11-30|    4|                A|                            4|             4|             4|      2|            NO|         2|        Marina|          Pitana|                300001|                350000|           1156|             325000.5|
| 17|Guillermo|  Ramrez|        IT|    2020-01-06|2022-05-31|    2|                A|                            3|             2|             2|      7|            NO|         7|        Martn|          Viglia|                200001|                250000|            876|             225000.5|
| 19|    Rocio|     Ruiz| Auditoria|    2018-02-05|2021-01-30|    4|                A|                            4|             4|             5|     10|            NO|        10|        Daniel|         Quiroga|                300001|                350000|           1090|             325000.5|
| 24|  Micaela|    Pauls|Produccin|    2019-01-07|2021-12-31|    6|                A|                            5|             6|             6|      4|            SI|         4|        Miriam|          Pisani|                400001|                500000|           1089|             450000.5|
| 27|  Rodrigo|  Molinas|   Compras|    2019-06-03|2022-04-30|    2|                A|                            4|             2|             2|      2|            SI|         2|        Marina|          Pitana|                200001|                250000|           1062|             225000.5|
| 28|  Martina| Oliviera|Produccin|    2020-01-06|2022-06-30|    7|                A|                            4|             6|             6|      6|            SI|         6|         Sonia|        Kamlasky|                400001|                500000|            906|             450000.5|
+---+---------+---------+----------+--------------+----------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> grupoA = df_silver.filter(df_silver['Grupo recruitment'] == 'A')
>>> grupoB = df_silver.filter(df_silver['Grupo recruitment'] == 'B')
>>> grupoC = df_silver.filter(df_silver['Grupo recruitment'] == 'C')
>>> grupoD = df_silver.filter(df_silver['Grupo recruitment'] == 'D')
>>> grupoD.show()
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
| Id|Nombre|Apellido|Area|Fecha comienzo|Fecha fin|Nivel|Grupo recruitment|Tiempo recruitment en semanas|Rango Salarial|RS competencia|Manager|Realizo Cursos|Id_Manager|Nombre_Manager|Apellido_Manager|sueldo en rublos desde|sueldo en rublos hasta|dias_trabajados|avg salario en rublos|
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+
+---+------+--------+----+--------------+---------+-----+-----------------+-----------------------------+--------------+--------------+-------+--------------+----------+--------------+----------------+----------------------+----------------------+---------------+---------------------+

>>> # Ok, el problema era que Grupo recruitment tenia espacios en blanco, entonces 'A' no era igual a ' A'
>>> df_bronze.printSchema()
root
 |-- Id: string (nullable = true)
 |-- Nombre: string (nullable = true)
 |-- Apellido: string (nullable = true)
 |-- Area: string (nullable = true)
 |-- Fecha comienzo: string (nullable = true)
 |-- Fecha fin: string (nullable = true)
 |-- Nivel: string (nullable = true)
 |-- Grupo recruitment: string (nullable = true)
 |-- Tiempo recruitment: string (nullable = true)
 |-- Rango Salarial: string (nullable = true)
 |-- RS competencia: string (nullable = true)
 |-- Manager: string (nullable = true)
 |-- Realizo Cursos: string (nullable = true)
 |-- Id_Manager: string (nullable = true)
 |-- Nombre_Manager: string (nullable = true)
 |-- Apellido_Manager: string (nullable = true)
 |-- Rango: string (nullable = true)
 |-- sueldo en rublos desde: string (nullable = true)
 |-- sueldo en rublos hasta: string (nullable = true)

>>> df_silver.printSchema()
root
 |-- Id: integer (nullable = true)
 |-- Nombre: string (nullable = true)
 |-- Apellido: string (nullable = true)
 |-- Area: string (nullable = true)
 |-- Fecha comienzo: date (nullable = true)
 |-- Fecha fin: date (nullable = true)
 |-- Nivel: integer (nullable = true)
 |-- Grupo recruitment: string (nullable = true)
 |-- Tiempo recruitment en semanas: integer (nullable = true)
 |-- Rango Salarial: integer (nullable = true)
 |-- RS competencia: integer (nullable = true)
 |-- Manager: string (nullable = true)
 |-- Realizo Cursos: string (nullable = true)
 |-- Id_Manager: string (nullable = true)
 |-- Nombre_Manager: string (nullable = true)
 |-- Apellido_Manager: string (nullable = true)
 |-- sueldo en rublos desde: integer (nullable = true)
 |-- sueldo en rublos hasta: integer (nullable = true)
 |-- dias_trabajados: integer (nullable = true)
 |-- avg salario en rublos: double (nullable = true)

>>> grupoA.printSchema()
root
 |-- Id: integer (nullable = true)
 |-- Nombre: string (nullable = true)
 |-- Apellido: string (nullable = true)
 |-- Area: string (nullable = true)
 |-- Fecha comienzo: date (nullable = true)
 |-- Fecha fin: date (nullable = true)
 |-- Nivel: integer (nullable = true)
 |-- Grupo recruitment: string (nullable = true)
 |-- Tiempo recruitment en semanas: integer (nullable = true)
 |-- Rango Salarial: integer (nullable = true)
 |-- RS competencia: integer (nullable = true)
 |-- Manager: string (nullable = true)
 |-- Realizo Cursos: string (nullable = true)
 |-- Id_Manager: string (nullable = true)
 |-- Nombre_Manager: string (nullable = true)
 |-- Apellido_Manager: string (nullable = true)
 |-- sueldo en rublos desde: integer (nullable = true)
 |-- sueldo en rublos hasta: integer (nullable = true)
 |-- dias_trabajados: integer (nullable = true)
 |-- avg salario en rublos: double (nullable = true)

>>> grupoB.printSchema()
root
 |-- Id: integer (nullable = true)
 |-- Nombre: string (nullable = true)
 |-- Apellido: string (nullable = true)
 |-- Area: string (nullable = true)
 |-- Fecha comienzo: date (nullable = true)
 |-- Fecha fin: date (nullable = true)
 |-- Nivel: integer (nullable = true)
 |-- Grupo recruitment: string (nullable = true)
 |-- Tiempo recruitment en semanas: integer (nullable = true)
 |-- Rango Salarial: integer (nullable = true)
 |-- RS competencia: integer (nullable = true)
 |-- Manager: string (nullable = true)
 |-- Realizo Cursos: string (nullable = true)
 |-- Id_Manager: string (nullable = true)
 |-- Nombre_Manager: string (nullable = true)
 |-- Apellido_Manager: string (nullable = true)
 |-- sueldo en rublos desde: integer (nullable = true)
 |-- sueldo en rublos hasta: integer (nullable = true)
 |-- dias_trabajados: integer (nullable = true)
 |-- avg salario en rublos: double (nullable = true)

>>> df_A = grupoA.select(['Id', 'Nombre', 'Apellido', 'Area', 'Manager', 'Nombre_Manager', 'Apellido_Manager', 'Nivel', 'dias_trabajados', 'avg salario en rublos'])
>>> df_B = grupoB.select(['Id', 'Nombre', 'Apellido', 'Area', 'Manager', 'Nombre_Manager', 'Apellido_Manager', 'Nivel', 'dias_trabajados', 'avg salario en rublos'])
>>> df_C = grupoC.select(['Id', 'Nombre', 'Apellido', 'Area', 'Manager', 'Nombre_Manager', 'Apellido_Manager', 'Nivel', 'dias_trabajados', 'avg salario en rublos'])
>>> df_A.printSchema()
root
 |-- Id: integer (nullable = true)
 |-- Nombre: string (nullable = true)
 |-- Apellido: string (nullable = true)
 |-- Area: string (nullable = true)
 |-- Manager: string (nullable = true)
 |-- Nombre_Manager: string (nullable = true)
 |-- Apellido_Manager: string (nullable = true)
 |-- Nivel: integer (nullable = true)
 |-- dias_trabajados: integer (nullable = true)
 |-- avg salario en rublos: double (nullable = true)

>>> df_B.printSchema()
root
 |-- Id: integer (nullable = true)
 |-- Nombre: string (nullable = true)
 |-- Apellido: string (nullable = true)
 |-- Area: string (nullable = true)
 |-- Manager: string (nullable = true)
 |-- Nombre_Manager: string (nullable = true)
 |-- Apellido_Manager: string (nullable = true)
 |-- Nivel: integer (nullable = true)
 |-- dias_trabajados: integer (nullable = true)
 |-- avg salario en rublos: double (nullable = true)

>>> df_C.printSchema()
root
 |-- Id: integer (nullable = true)
 |-- Nombre: string (nullable = true)
 |-- Apellido: string (nullable = true)
 |-- Area: string (nullable = true)
 |-- Manager: string (nullable = true)
 |-- Nombre_Manager: string (nullable = true)
 |-- Apellido_Manager: string (nullable = true)
 |-- Nivel: integer (nullable = true)
 |-- dias_trabajados: integer (nullable = true)
 |-- avg salario en rublos: double (nullable = true)

>>> df_bronze.write.insertInto("edvai_rrhh.bronze")
2024-05-08 20:50:34,140 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
2024-05-08 20:50:35,886 WARN session.SessionState: METASTORE_FILTER_HOOK will be ignored, since hive.security.authorization.manager is set to instance of HiveAuthorizerFactory.
>>> df_silver.write.insertInto("edvai_rrhh.silver")                 
>>> df_A.write.insertInto("edvai_rrhh.grupo_a")                     
>>> df_B.write.insertInto("edvai_rrhh.grupo_b")                               
>>> df_C.write.insertInto("edvai_rrhh.grupo_c")
>>>                                       